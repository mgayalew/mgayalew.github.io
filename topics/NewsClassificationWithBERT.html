<!DOCTYPE html>
<html lang="en">
	<head>
	<meta charset="utf-8" />

	<title>Muluemebet G Ayalew</title>
	<link rel="stylesheet" type="text/css" href="../stylesheets/style-News-Classification.css">
	<link rel="stylesheet" type="text/css" href="../stylesheets/style-headerfooterside.css">
	<link rel="stylesheet" type="text/css" href="../stylesheets/style-bodyandothers.css">

<body>
	
	<!-- Page header rows -->
	<ul class="ul-first-nav-bar">
		<li class="li-first-nav-bar"><a class="a-webpage-name active">DataScienceAndMe.com</a></li>
	</ul>
	<ul class="ul-first-nav-bar">
		<li class="li-first-nav-bar"><a class="a-mt-header-name active">Muluemebet G Ayalew Page </a></li>
		<li class="li-first-nav-bar"><a class="active">&#9742; 518-445-5698 </a></li>
		<li class="li-first-nav-bar"><a class="active" href="mailto:mg.ayalew@gmail.com?Subject=">&#9993; mg.ayalew@gmail.com</a></li>
		<li class="li-first-nav-bar"><a class="active" href="../documents/ayalew_resume.pdf">Resume</a></li>
		<li class="li-first-nav-bar"><a class="active" href="https://www.linkedin.com/in/muluemebet-g-ayalew-8a91a310" target="_blank"><img src="../images/linkedin_logo.png" alt="Picture" style="width:50px;height:18px; align: left; vertical-align: middle;"></a></li>
		<li class="li-first-nav-bar"><a class="active" href="https://github.com/mgayalew" target="_blank"><img src="../images/github_logo.jpg" alt="Picture" style="width:25px;height:25px; align: left; vertical-align: middle;"></a></li>
	</ul>
	<ul class="ul-second-nav-bar">
		<li class="li-second-nav-bar"><a class="active" href="../index.html">Home</a></li>  
		<li class="li-second-nav-bar"><a href="../about.html">About</a></li>  
		<li class="li-second-nav-bar"><a href="../projects.html">Projects</a></li>  
		<li class="li-second-nav-bar"><a href="../education.html">Education</a></li>  
		<li class="li-second-nav-bar"><a href="../certificateskill.html">Data Science Certificates & Skills</a></li> 

	</ul> 


<!-- Header end here -->	

<script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.1.10/require.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>

<script>
(function() {
  function addWidgetsRenderer() {
    var mimeElement = document.querySelector('script[type="application/vnd.jupyter.widget-view+json"]');
    var scriptElement = document.createElement('script');
    var widgetRendererSrc = '@jupyter-widgets/html-manager@*/dist/embed-amd.js';
    var widgetState;

    // Fallback for older version:
    try {
      widgetState = mimeElement && JSON.parse(mimeElement.innerHTML);

      if (widgetState && (widgetState.version_major < 2 || !widgetState.version_major)) {
        widgetRendererSrc = 'jupyter-js-widgets@*/dist/embed.js';
      }
    } catch(e) {}

    scriptElement.src = widgetRendererSrc;
    document.body.appendChild(scriptElement);
  }

  document.addEventListener('DOMContentLoaded', addWidgetsRenderer);
}());
</script>


<!-- Custom stylesheet, it must be in the same directory as the html file -->
<link rel="stylesheet" href="custom.css">

<!-- Loading mathjax macro -->
<!-- Load mathjax -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS_HTML"></script>
    <!-- MathJax configuration -->
    <script type="text/x-mathjax-config">
    MathJax.Hub.Config({
        tex2jax: {
            inlineMath: [ ['$','$'], ["\\(","\\)"] ],
            displayMath: [ ['$$','$$'], ["\\[","\\]"] ],
            processEscapes: true,
            processEnvironments: true
        },
        // Center justify equations in code and markdown cells. Elsewhere
        // we use CSS to left justify single line equations in code cells.
        displayAlign: 'center',
        "HTML-CSS": {
            styles: {'.MathJax_Display': {"margin": 0}},
            linebreaks: { automatic: true }
        }
    });
    </script>
    <!-- End of mathjax configuration -->
	</head>
		
  <div tabindex="-1" id="notebook" class="border-box-sizing">
    <div class="container" id="notebook-container">

<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="News-classification-using-BERT">News Classification with BERT<a class="anchor-link" href="#News-classification-using-BERT">&#182;</a></h2><p>In this post, I used Bidirectional Encoder Representations from Transformers (BERT) to classify whether a news is fake or real. BERT is a state-of-the-art technique for Natural Language Processing (NLP) created and published by Google in 2018. Bidirectional means that it looks both left and right context to understand the text. It can be used for next sentence prediction, question answering, language inference and more. Here, we used BERT for news classification using <a href="https://huggingface.co/transformers">transformers library</a> from Hugging Face. Transformers allows PyTorch interface.</p>
<p>The analysis was created and executed through Google colaboratory notebook and can be accessible <a href= "https://colab.research.google.com/drive/13IzNRUhnOdbMnS2PZiKLbi_c1pDV3obO?usp=sharing">here</a>. <a href="https://colab.research.google.com/notebooks/intro.ipynb">Google colaboratory</a>, or in short Colab, is a free research tool provided by Google to execute python and perform machine learning tasks. It can allow us to set Graphics Processing Unit (GPU) or Tensor Processing Unit (TPU).</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Import libraries</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[9]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># Important libraries</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">re</span> <span class="c1"># to use regular expression pattern </span>
<span class="kn">import</span> <span class="nn">datetime</span> <span class="k">as</span> <span class="nn">dt</span>  <span class="c1"># to parse to datetime</span>
<span class="kn">import</span> <span class="nn">string</span>
<span class="kn">from</span> <span class="nn">scipy</span> <span class="kn">import</span> <span class="n">stats</span>
<span class="kn">from</span> <span class="nn">collections</span> <span class="kn">import</span> <span class="n">defaultdict</span>

<span class="c1">#for data preprocessing</span>
<span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">train_test_split</span>  

<span class="c1"># to evaluate model performance</span>
<span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">confusion_matrix</span><span class="p">,</span> <span class="n">classification_report</span>

<span class="c1"># for visualization</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">from</span> <span class="nn">matplotlib</span> <span class="kn">import</span> <span class="n">rc</span>
<span class="kn">from</span> <span class="nn">pylab</span> <span class="kn">import</span> <span class="n">rcParams</span>
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span> 
<span class="o">%</span><span class="k">matplotlib</span> inline
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The analysis is discussed step by step as follows:</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="1)Read-the-data">1)Read the data<a class="anchor-link" href="#1)Read-the-data">&#182;</a></h2><p>The data is <a href="https://www.kaggle.com/clmentbisaillon/fake-and-real-news-dataset">publicly available</a> and can be downloaded as fake and true news separately. I downloaded the data on the local machine and read from there. Though there are different <a href="https://towardsdatascience.com/importing-data-to-google-colab-the-clean-way-5ceef9e9e3c8">ways to get data into Google Colab</a>, I get the data by mounting my Google Drive into Colab environment.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[10]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">true</span><span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;drive/My Drive/NLP_files/True.csv&quot;</span><span class="p">,</span> <span class="n">parse_dates</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;date&quot;</span><span class="p">])</span>     <span class="c1"># the true news data</span>
<span class="n">fake</span><span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;drive/My Drive/NLP_files/Fake.csv&quot;</span><span class="p">)</span>     <span class="c1"># the fake news data</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[11]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">true</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="c1"># the first few rows of real dataframe</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[11]:</div>



<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>title</th>
      <th>text</th>
      <th>subject</th>
      <th>date</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>As U.S. budget fight looms, Republicans flip t...</td>
      <td>WASHINGTON (Reuters) - The head of a conservat...</td>
      <td>politicsNews</td>
      <td>2017-12-31</td>
    </tr>
    <tr>
      <th>1</th>
      <td>U.S. military to accept transgender recruits o...</td>
      <td>WASHINGTON (Reuters) - Transgender people will...</td>
      <td>politicsNews</td>
      <td>2017-12-29</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Senior U.S. Republican senator: 'Let Mr. Muell...</td>
      <td>WASHINGTON (Reuters) - The special counsel inv...</td>
      <td>politicsNews</td>
      <td>2017-12-31</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[12]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">fake</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[12]:</div>



<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>title</th>
      <th>text</th>
      <th>subject</th>
      <th>date</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Donald Trump Sends Out Embarrassing New Year’...</td>
      <td>Donald Trump just couldn t wish all Americans ...</td>
      <td>News</td>
      <td>December 31, 2017</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Drunk Bragging Trump Staffer Started Russian ...</td>
      <td>House Intelligence Committee Chairman Devin Nu...</td>
      <td>News</td>
      <td>December 31, 2017</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Sheriff David Clarke Becomes An Internet Joke...</td>
      <td>On Friday, it was revealed that former Milwauk...</td>
      <td>News</td>
      <td>December 30, 2017</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[13]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># the size of fake and true news data sets</span>
<span class="n">true</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">fake</span><span class="o">.</span><span class="n">shape</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[13]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>((21417, 4), (23481, 4))</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="1.1)-Add-labels(fake/true)-to-the--dataframs">1.1) Add labels(fake/true) to the  dataframs<a class="anchor-link" href="#1.1)-Add-labels(fake/true)-to-the--dataframs">&#182;</a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[14]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># create a new column called is_fake and label as 0 for true news </span>
<span class="n">true</span><span class="p">[</span><span class="s2">&quot;label&quot;</span><span class="p">]</span><span class="o">=</span><span class="s2">&quot;true&quot;</span>
<span class="c1"># create a new column called is_fake and label as 1 for fake news </span>
<span class="n">fake</span><span class="p">[</span><span class="s2">&quot;label&quot;</span><span class="p">]</span><span class="o">=</span> <span class="s2">&quot;fake&quot;</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[15]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># parse the date column into datetime. </span>
<span class="c1">#Since it has three datetime format, we need three formats to parse.  </span>
<span class="k">def</span> <span class="nf">parsing_datetime</span><span class="p">(</span><span class="n">string</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="p">(</span><span class="s2">&quot;%B </span><span class="si">%d</span><span class="s2">, %Y&quot;</span><span class="p">,</span> <span class="s1">&#39;</span><span class="si">%d</span><span class="s1">-%b-%y&#39;</span><span class="p">,</span> <span class="s2">&quot;%b </span><span class="si">%d</span><span class="s2">, %Y&quot;</span><span class="p">):</span> <span class="c1"># format  19-Feb-18</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">dt</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">strptime</span><span class="p">(</span><span class="n">string</span><span class="p">,</span> <span class="n">f</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
            <span class="k">pass</span>
        
<span class="c1"># parse the date column of fake dataframe into datetime</span>
<span class="n">fake</span><span class="o">.</span><span class="n">date</span><span class="o">=</span> <span class="n">fake</span><span class="o">.</span><span class="n">date</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">parsing_datetime</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="1.2)-Merge-the-real-and-fake-news-dataframes">1.2) Merge the real and fake news dataframes<a class="anchor-link" href="#1.2)-Merge-the-real-and-fake-news-dataframes">&#182;</a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[16]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># Merge the fake and read dataframe</span>
<span class="n">news</span><span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">true</span><span class="p">,</span><span class="n">fake</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">ignore_index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> <span class="c1"># index to have unique index</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[17]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">news</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[17]:</div>



<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>title</th>
      <th>text</th>
      <th>subject</th>
      <th>date</th>
      <th>label</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>As U.S. budget fight looms, Republicans flip t...</td>
      <td>WASHINGTON (Reuters) - The head of a conservat...</td>
      <td>politicsNews</td>
      <td>2017-12-31</td>
      <td>true</td>
    </tr>
    <tr>
      <th>1</th>
      <td>U.S. military to accept transgender recruits o...</td>
      <td>WASHINGTON (Reuters) - Transgender people will...</td>
      <td>politicsNews</td>
      <td>2017-12-29</td>
      <td>true</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Senior U.S. Republican senator: 'Let Mr. Muell...</td>
      <td>WASHINGTON (Reuters) - The special counsel inv...</td>
      <td>politicsNews</td>
      <td>2017-12-31</td>
      <td>true</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[18]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">sns</span><span class="o">.</span><span class="n">countplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s2">&quot;label&quot;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">news</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Count plot of fake and true news&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>




<div class="output_png output_subarea ">
<img src="data:image/png;base64,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
"
>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="2)-Data-Cleaning-and-Preprocessing">2) Data Cleaning and Preprocessing<a class="anchor-link" href="#2)-Data-Cleaning-and-Preprocessing">&#182;</a></h3><p>Regular expression patterns have been used to detect and remove emoji symbols, url links, html tags, special characters and punctuation marks.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[19]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">remove_pattern</span><span class="p">(</span><span class="n">text</span><span class="p">,</span> <span class="n">patterns</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;The function remove_pattern returns the new string with a set of patterns removed.</span>
<span class="sd">       Parameters:</span>
<span class="sd">       ------------</span>
<span class="sd">       text: the text from which the pattern will be removed</span>
<span class="sd">       patterns: is the set of patterns(iterable) we are interested to remove from the text</span>
<span class="sd">       &quot;&quot;&quot;</span>
           
    <span class="k">for</span> <span class="n">pattern</span> <span class="ow">in</span> <span class="n">patterns</span><span class="p">:</span>
        <span class="n">new</span><span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="n">pattern</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">text</span><span class="p">)</span>
        <span class="n">text</span><span class="o">=</span> <span class="n">new</span> 
    <span class="k">return</span> <span class="n">new</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[20]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># patterns to be extracted and to be removed from the data </span>
<span class="n">emoji</span> <span class="o">=</span> <span class="s2">&quot;[</span><span class="se">\U0001F300</span><span class="s2">-</span><span class="se">\U0001F5FF\U0001F600</span><span class="s2">-</span><span class="se">\U0001F64F\U0001F680</span><span class="s2">-</span><span class="se">\U0001F6FF\u2600</span><span class="s2">-</span><span class="se">\u26FF\u2700</span><span class="s2">-</span><span class="se">\u27BF\U000024C2</span><span class="s2">-</span><span class="se">\U0001F251</span><span class="s2">]+&quot;</span>

<span class="n">url</span><span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="s2">&quot;https?://\S+|www\.\S+&quot;</span><span class="p">)</span>                     <span class="c1"># pattern for url</span>
<span class="n">html</span><span class="o">=</span> <span class="sa">r</span><span class="s1">&#39;&lt;.*?&gt;&#39;</span>                                               <span class="c1"># pattern for html tag</span>
<span class="n">num_with_text</span><span class="o">=</span> <span class="sa">r</span><span class="s2">&quot;\S*\d+\S*&quot;</span>                                  <span class="c1"># pattern for digit </span>
<span class="n">reuters</span><span class="o">=</span> <span class="sa">r</span><span class="s2">&quot;(\s\(Reuters\))&quot;</span>                                  <span class="c1"># pattern to detect Reuters, it is common word in true news</span>
<span class="n">punctuation</span><span class="o">=</span> <span class="sa">r</span><span class="s2">&quot;[#@&amp;%$~=\.;:\?,()</span><span class="si">{}</span><span class="se">\&quot;</span><span class="s2">\“\”\‘\&#39;\*!\+`^&lt;&gt;\[\]\-]+&quot;</span>      <span class="c1">#pattern for punctuations and special characters   </span>
<span class="n">apostroph</span><span class="o">=</span><span class="sa">r</span><span class="s2">&quot;\’s?&quot;</span>
<span class="c1"># collect the patterns </span>
<span class="n">patterns</span><span class="o">=</span><span class="p">[</span><span class="n">emoji</span><span class="p">,</span> <span class="n">url</span><span class="p">,</span> <span class="n">html</span><span class="p">,</span> <span class="n">num_with_text</span><span class="p">,</span> <span class="n">apostroph</span><span class="p">,</span><span class="n">reuters</span><span class="p">,</span><span class="n">punctuation</span><span class="p">]</span> <span class="c1"># punctuation removed</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="2.1)-Clean-merged-data">2.1) Clean merged data<a class="anchor-link" href="#2.1)-Clean-merged-data">&#182;</a></h3><p>At this statage of data cleaning ,the emoji, url links, html tag, digits and special characters are removed.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[21]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># Clean the title and text of merged data using regular expression patterns</span>
<span class="n">news_clean_title</span> <span class="o">=</span> <span class="n">news</span><span class="o">.</span><span class="n">title</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">remove_pattern</span><span class="p">,</span> <span class="n">patterns</span><span class="o">=</span> <span class="n">patterns</span><span class="p">)</span>
<span class="n">news_clean_text</span><span class="o">=</span> <span class="n">news</span><span class="o">.</span><span class="n">text</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">remove_pattern</span><span class="p">,</span> <span class="n">patterns</span><span class="o">=</span> <span class="n">patterns</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="2.2)-Split-the-data-into-training,-validating-and-test-data">2.2) Split the data into training, validating and test data<a class="anchor-link" href="#2.2)-Split-the-data-into-training,-validating-and-test-data">&#182;</a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[22]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">news</span><span class="p">[</span><span class="s2">&quot;cleaned_title&quot;</span><span class="p">]</span><span class="o">=</span> <span class="n">news_clean_title</span> <span class="c1"># add the cleaned title as new column </span>
<span class="n">news</span><span class="p">[</span><span class="s2">&quot;cleaned_text&quot;</span><span class="p">]</span><span class="o">=</span> <span class="n">news_clean_text</span>  <span class="c1"># add the cleaned text as new column </span>
<span class="n">dicmap</span><span class="o">=</span> <span class="p">{</span><span class="s2">&quot;true&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;fake&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">}</span> <span class="c1"># lable true news as 0 and fake news as 1</span>
<span class="n">news</span><span class="p">[</span><span class="s2">&quot;is_fake&quot;</span><span class="p">]</span><span class="o">=</span> <span class="n">news</span><span class="o">.</span><span class="n">label</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">dicmap</span><span class="p">[</span><span class="n">x</span><span class="p">])</span> 
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[23]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">news</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[23]:</div>



<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>title</th>
      <th>text</th>
      <th>subject</th>
      <th>date</th>
      <th>label</th>
      <th>cleaned_title</th>
      <th>cleaned_text</th>
      <th>is_fake</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>As U.S. budget fight looms, Republicans flip t...</td>
      <td>WASHINGTON (Reuters) - The head of a conservat...</td>
      <td>politicsNews</td>
      <td>2017-12-31</td>
      <td>true</td>
      <td>As US budget fight looms Republicans flip thei...</td>
      <td>WASHINGTON  The head of a conservative Republi...</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>U.S. military to accept transgender recruits o...</td>
      <td>WASHINGTON (Reuters) - Transgender people will...</td>
      <td>politicsNews</td>
      <td>2017-12-29</td>
      <td>true</td>
      <td>US military to accept transgender recruits on ...</td>
      <td>WASHINGTON  Transgender people will be allowed...</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[24]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># copy the news to data_brt split into training, validating and test set</span>
<span class="n">data_brt</span><span class="o">=</span> <span class="n">news</span><span class="p">[[</span><span class="s2">&quot;cleaned_title&quot;</span><span class="p">,</span><span class="s2">&quot;cleaned_text&quot;</span><span class="p">,</span><span class="s2">&quot;is_fake&quot;</span><span class="p">,</span><span class="s2">&quot;label&quot;</span><span class="p">]]</span> 
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[25]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">data_brt</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[25]:</div>



<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>cleaned_title</th>
      <th>cleaned_text</th>
      <th>is_fake</th>
      <th>label</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>As US budget fight looms Republicans flip thei...</td>
      <td>WASHINGTON  The head of a conservative Republi...</td>
      <td>0</td>
      <td>true</td>
    </tr>
    <tr>
      <th>1</th>
      <td>US military to accept transgender recruits on ...</td>
      <td>WASHINGTON  Transgender people will be allowed...</td>
      <td>0</td>
      <td>true</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Senior US Republican senator Let Mr Mueller do...</td>
      <td>WASHINGTON  The special counsel investigation ...</td>
      <td>0</td>
      <td>true</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[26]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1">#train_data, validate_data, test_data (70%, 15%, 15% respectively)</span>
<span class="n">train_data</span><span class="p">,</span> <span class="n">validate_data</span><span class="p">,</span> <span class="n">test_data</span><span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">data_brt</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="n">frac</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">),</span> <span class="p">[</span> <span class="nb">int</span><span class="p">(</span><span class="o">.</span><span class="mi">7</span><span class="o">*</span><span class="nb">len</span><span class="p">(</span><span class="n">news</span><span class="p">)),</span> <span class="nb">int</span><span class="p">(</span><span class="o">.</span><span class="mi">85</span><span class="o">*</span><span class="nb">len</span><span class="p">(</span><span class="n">news</span><span class="p">))])</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[27]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># size of trainng, validating and test data</span>
<span class="n">train_data</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">validate_data</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">test_data</span><span class="o">.</span><span class="n">shape</span> 
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[27]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>((31428, 4), (6735, 4), (6735, 4))</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="3)-Classification-using-BERT:-Using-Transformers-library-from-Hugging-Face">3) Classification using BERT: Using Transformers library from Hugging Face<a class="anchor-link" href="#3)-Classification-using-BERT:-Using-Transformers-library-from-Hugging-Face">&#182;</a></h2><p>Note that the steps in this section are similar to the steps in Valkov article posted in <a href="https://www.curiousily.com/posts/sentiment-analysis-with-bert-and-hugging-face-using-pytorch-and-python/">Curiously blog</a> with some adaptation to the data at hand.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[75]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="o">!</span>pip install -qq transformers 
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[29]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># For  BERT tokenization and modeling </span>
<span class="kn">import</span> <span class="nn">transformers</span>
<span class="kn">from</span> <span class="nn">transformers</span> <span class="kn">import</span> <span class="n">BertModel</span><span class="p">,</span> <span class="n">BertTokenizer</span><span class="p">,</span> <span class="n">AdamW</span><span class="p">,</span> <span class="n">get_linear_schedule_with_warmup</span>
<span class="kn">import</span> <span class="nn">torch</span>
<span class="kn">from</span> <span class="nn">textwrap</span> <span class="kn">import</span> <span class="n">wrap</span>
<span class="kn">from</span> <span class="nn">torch</span> <span class="kn">import</span> <span class="n">nn</span><span class="p">,</span> <span class="n">optim</span>
<span class="kn">from</span> <span class="nn">torch.utils.data</span> <span class="kn">import</span> <span class="n">Dataset</span><span class="p">,</span> <span class="n">DataLoader</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[30]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">device</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">device</span><span class="p">(</span><span class="s2">&quot;cuda:0&quot;</span> <span class="k">if</span> <span class="n">torch</span><span class="o">.</span><span class="n">cuda</span><span class="o">.</span><span class="n">is_available</span><span class="p">()</span> <span class="k">else</span> <span class="s2">&quot;cpu&quot;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[31]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">device</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[31]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>device(type=&#39;cuda&#39;, index=0)</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="3.1)-Tokenization">3.1) Tokenization<a class="anchor-link" href="#3.1)-Tokenization">&#182;</a></h3><p>Tokenization is the process of breaking a text into smaller units called tokens. For example, breaking a sentence into a list of words. BERT provides the option to be case sensitive (uppercase or lowercase characters) or to be case-insensitive. In our case, the case-insensitive(uncased) version of BERT is used.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[32]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># uncased version of BERT</span>
<span class="n">PRE_TRAINED_MODEL_NAME</span> <span class="o">=</span> <span class="s1">&#39;bert-base-uncased&#39;</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[33]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">tokenizer</span> <span class="o">=</span> <span class="n">BertTokenizer</span><span class="o">.</span><span class="n">from_pretrained</span><span class="p">(</span><span class="n">PRE_TRAINED_MODEL_NAME</span><span class="p">,</span> <span class="n">do_lower_case</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>





 
 
<div id="83d8f300-909b-4659-b495-dc9a1327ff14"></div>
<div class="output_subarea output_widget_view ">
<script type="text/javascript">
var element = $('#83d8f300-909b-4659-b495-dc9a1327ff14');
</script>
<script type="application/vnd.jupyter.widget-view+json">
{"model_id": "62fc827cbc814e8aa89b19adb4cc852e", "version_major": 2, "version_minor": 0}
</script>
</div>

</div>

<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[34]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">train_data</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span> <span class="c1"># get a sample news title from the training data </span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[34]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>&#39; BREAKING GOP Chairman Grassley Has Had Enough DEMANDS Trump Jr Testimony&#39;</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[35]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">sample_txt</span><span class="o">=</span><span class="n">train_data</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[36]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># tokenizing sample text from training data </span>
<span class="n">encoding</span> <span class="o">=</span> <span class="n">tokenizer</span><span class="o">.</span><span class="n">encode_plus</span><span class="p">(</span>
  <span class="n">sample_txt</span><span class="p">,</span>
  <span class="n">max_length</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span>
  <span class="n">add_special_tokens</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="c1"># Add &#39;[CLS]&#39; and &#39;[SEP]&#39;</span>
  <span class="n">return_token_type_ids</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
  <span class="n">padding</span><span class="o">=</span><span class="s1">&#39;max_length&#39;</span><span class="p">,</span>
  <span class="n">return_attention_mask</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
  <span class="n">return_tensors</span><span class="o">=</span><span class="s1">&#39;pt&#39;</span><span class="p">,</span>  <span class="c1"># Return PyTorch tensors</span>
  <span class="n">truncation</span><span class="o">=</span><span class="kc">True</span> <span class="c1"># to truncate excess tokens to meet the maximum length</span>
<span class="p">)</span>
<span class="n">encoding</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[36]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>dict_keys([&#39;input_ids&#39;, &#39;attention_mask&#39;])</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Parameter explanation :</p>
<ul>
<li>max_length: has integer value to pass sequency of constance length, controls the length for padding/truncation</li>
<li>add_special_tokens: has boolean value  to add special  tokens such as [CLS] to add at the start of each sentence and [SEP] to mark ending of a sentence. </li>
<li>return_token_type_ids: has boolean value to whether to return token type IDs(list of token type ids to be fed to a model).</li>
<li>padding: activates and control padding. If set to 'max_length' pad to a maximum length specified with the argument max_length.Creats array of 0s (pad token) and 1s (real token) called attention mask</li>
<li>return_attention_mask: Whether to return the attention mask, indicates to the model which tokens should be attended to, and which should not.</li>
<li>return_tensors:  Can be set to ‘tf’, ‘pt’ or ‘np’ to return TensorFlow tf.constant, PyTorch torch.Tensor or Numpy, respectively.</li>
<li>truncation: has boolean value to control truncation</li>
</ul>
<p>For more parameters and detailed explanations please refere <a href="https://huggingface.co/transformers/main_classes/tokenizer.html#transformers.PreTrainedTokenizer">here</a>.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[37]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">encoding</span><span class="p">[</span><span class="s2">&quot;input_ids&quot;</span><span class="p">]</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[37]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>tensor([[  101,  4911,  2175,  2361,  3472,  5568,  3051,  2038,  2018,  2438,
          7670,  8398,  3781, 10896,   102,     0,     0,     0,     0,     0]])</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[38]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">encoding</span><span class="p">[</span><span class="s2">&quot;attention_mask&quot;</span><span class="p">]</span><span class="c1"># shows 1 for real token and 0 for pad tokens </span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[38]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>tensor([[1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0]])</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><strong>Set the maximum length for our training data</strong></p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>To set the max_length, let us look at token length in the news title. In this post only the title of the news was considered for the analysis and for classification. Even though the text of the news has detailed information and has better prediction potential, due to the limited memory capacity of the free version of Google colab, we couldn't use the text of the news for classification. But a similar approach can be applied to use the text of the news for prediction.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[39]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">token_length</span><span class="o">=</span><span class="p">[]</span> <span class="c1"># place holder to count the number of tokens in news </span>
<span class="k">for</span> <span class="n">ttl</span> <span class="ow">in</span> <span class="n">data_brt</span><span class="o">.</span><span class="n">cleaned_title</span><span class="p">:</span>
  <span class="n">tokens</span> <span class="o">=</span> <span class="n">tokenizer</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="n">ttl</span><span class="p">,</span> <span class="n">max_length</span><span class="o">=</span><span class="mi">512</span><span class="p">,</span> <span class="n">truncation</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
  <span class="n">token_length</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">tokens</span><span class="p">))</span> <span class="c1"># list of token count of each news title</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[40]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span><span class="mi">4</span><span class="p">))</span>
<span class="c1">#sns.distplot(token_length)</span>
<span class="n">sns</span><span class="o">.</span><span class="n">countplot</span><span class="p">(</span><span class="n">token_length</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Frequency of token count&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Number of tokens in news title&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Frequency&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>




<div class="output_png output_subarea ">
<img src="data:image/png;base64,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
"
>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[41]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># see the median, 95% quantile and maximum token count</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;median number of tokens = </span><span class="si">{}</span><span class="s2">,95% quantile = </span><span class="si">{}</span><span class="s2">, maximum number of tokens = </span><span class="si">{}</span><span class="s2">&quot;</span>\
      <span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">median</span><span class="p">(</span><span class="n">token_length</span><span class="p">),</span><span class="n">np</span><span class="o">.</span><span class="n">quantile</span><span class="p">(</span><span class="n">token_length</span><span class="p">,</span><span class="mf">0.95</span><span class="p">),</span><span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">token_length</span><span class="p">)))</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>median number of tokens = 15.0,95% quantile = 26.0, maximum number of tokens = 60
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>To be safe, we can set the maximum length as 60. But we can also set a lesser number as the majority of token counts are below 30.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[42]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">max_len</span><span class="o">=</span> <span class="mi">60</span>  <span class="c1"># maximum length</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[43]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># define a class that can tokenize the data</span>
<span class="k">class</span> <span class="nc">NewsDataset</span><span class="p">(</span><span class="n">Dataset</span><span class="p">):</span>
  <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">text</span><span class="p">,</span> <span class="n">targets</span><span class="p">,</span> <span class="n">tokenizer</span><span class="p">,</span> <span class="n">max_len</span><span class="p">):</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">text</span> <span class="o">=</span> <span class="n">text</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">targets</span> <span class="o">=</span> <span class="n">targets</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">tokenizer</span> <span class="o">=</span> <span class="n">tokenizer</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">max_len</span> <span class="o">=</span> <span class="n">max_len</span>
  <span class="k">def</span> <span class="fm">__len__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">text</span><span class="p">)</span>
  <span class="k">def</span> <span class="fm">__getitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">item</span><span class="p">):</span>
    <span class="n">row</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">text</span><span class="p">[</span><span class="n">item</span><span class="p">])</span>
    <span class="n">target</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">targets</span><span class="p">[</span><span class="n">item</span><span class="p">]</span>
    <span class="n">encoding</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tokenizer</span><span class="o">.</span><span class="n">encode_plus</span><span class="p">(</span>
      <span class="n">row</span><span class="p">,</span>
      <span class="n">add_special_tokens</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
      <span class="n">max_length</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">max_len</span><span class="p">,</span>
      <span class="n">return_token_type_ids</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
      <span class="n">padding</span><span class="o">=</span><span class="s2">&quot;max_length&quot;</span><span class="p">,</span>
      <span class="n">return_attention_mask</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
      <span class="n">truncation</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="c1"># to truncate excess tokens to meet the maximum length</span>
      <span class="n">return_tensors</span><span class="o">=</span><span class="s1">&#39;pt&#39;</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="k">return</span> <span class="p">{</span>
      <span class="s1">&#39;row_text&#39;</span><span class="p">:</span> <span class="n">row</span><span class="p">,</span>
      <span class="s1">&#39;input_ids&#39;</span><span class="p">:</span> <span class="n">encoding</span><span class="p">[</span><span class="s1">&#39;input_ids&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">flatten</span><span class="p">(),</span>
      <span class="s1">&#39;attention_mask&#39;</span><span class="p">:</span> <span class="n">encoding</span><span class="p">[</span><span class="s1">&#39;attention_mask&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">flatten</span><span class="p">(),</span>
      <span class="s1">&#39;targets&#39;</span><span class="p">:</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">(</span><span class="n">target</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">torch</span><span class="o">.</span><span class="n">long</span><span class="p">)</span>
    <span class="p">}</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="Data-loader">Data loader<a class="anchor-link" href="#Data-loader">&#182;</a></h4><p>The following function is specifically defined for the title of the news. For the text of the news, use similar approach but the input data has to be the column "cleaned_text".</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[44]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span>  <span class="c1"># cleate dataloader for news title</span>
<span class="k">def</span> <span class="nf">create_data_loader</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">tokenizer</span><span class="p">,</span> <span class="n">max_len</span><span class="p">,</span> <span class="n">batch_size</span><span class="p">):</span>
    <span class="n">ds</span> <span class="o">=</span> <span class="n">NewsDataset</span><span class="p">(</span>
    <span class="n">text</span><span class="o">=</span><span class="n">data</span><span class="o">.</span><span class="n">cleaned_title</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">(),</span>
    <span class="n">targets</span><span class="o">=</span><span class="n">data</span><span class="o">.</span><span class="n">is_fake</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">(),</span>
    <span class="n">tokenizer</span><span class="o">=</span><span class="n">tokenizer</span><span class="p">,</span>
    <span class="n">max_len</span><span class="o">=</span><span class="n">max_len</span>
    <span class="p">)</span>
    <span class="k">return</span> <span class="n">DataLoader</span><span class="p">(</span><span class="n">ds</span><span class="p">,</span><span class="n">batch_size</span><span class="o">=</span><span class="n">batch_size</span><span class="p">,</span> <span class="n">num_workers</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>

<span class="n">BATCH_SIZE</span> <span class="o">=</span> <span class="mi">16</span> 
<span class="n">train_data_loader</span> <span class="o">=</span> <span class="n">create_data_loader</span><span class="p">(</span><span class="n">train_data</span><span class="p">,</span> <span class="n">tokenizer</span><span class="p">,</span> <span class="n">max_len</span><span class="p">,</span> <span class="n">BATCH_SIZE</span><span class="p">)</span>
<span class="n">val_data_loader</span> <span class="o">=</span> <span class="n">create_data_loader</span><span class="p">(</span><span class="n">validate_data</span><span class="p">,</span> <span class="n">tokenizer</span><span class="p">,</span> <span class="n">max_len</span><span class="p">,</span> <span class="n">BATCH_SIZE</span><span class="p">)</span>
<span class="n">test_data_loader</span> <span class="o">=</span> <span class="n">create_data_loader</span><span class="p">(</span><span class="n">test_data</span><span class="p">,</span> <span class="n">tokenizer</span><span class="p">,</span> <span class="n">max_len</span><span class="p">,</span> <span class="n">BATCH_SIZE</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[45]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">data</span> <span class="o">=</span> <span class="nb">next</span><span class="p">(</span><span class="nb">iter</span><span class="p">(</span><span class="n">train_data_loader</span><span class="p">))</span> <span class="c1"># get </span>
<span class="n">data</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[45]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>dict_keys([&#39;row_text&#39;, &#39;input_ids&#39;, &#39;attention_mask&#39;, &#39;targets&#39;])</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[46]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># the shape of input_ids, attention_mask and targets for a batch of 16</span>
<span class="nb">print</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;input_ids&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="c1"># batch size * max_length</span>
<span class="nb">print</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;attention_mask&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>  <span class="c1"># batch size * max_length</span>
<span class="nb">print</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;targets&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>torch.Size([16, 60])
torch.Size([16, 60])
torch.Size([16])
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Let us see how the result looks like:</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[47]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;row_text&quot;</span><span class="p">][</span><span class="mi">0</span><span class="p">:</span><span class="mi">2</span><span class="p">]</span> <span class="c1"># the first two news title in training data</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[47]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>[&#39; BREAKING GOP Chairman Grassley Has Had Enough DEMANDS Trump Jr Testimony&#39;,
 &#39; Failed GOP Candidates Remembered In Hilarious Mocking Eulogies VIDEO&#39;]</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[48]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;input_ids&#39;</span><span class="p">][:</span><span class="mi">2</span><span class="p">])</span> <span class="c1"># the first two news input_ids in training data</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>tensor([[  101,  4911,  2175,  2361,  3472,  5568,  3051,  2038,  2018,  2438,
          7670,  8398,  3781, 10896,   102,     0,     0,     0,     0,     0,
             0,     0,     0,     0,     0,     0,     0,     0,     0,     0,
             0,     0,     0,     0,     0,     0,     0,     0,     0,     0,
             0,     0,     0,     0,     0,     0,     0,     0,     0,     0,
             0,     0,     0,     0,     0,     0,     0,     0,     0,     0],
        [  101,  3478,  2175,  2361,  5347,  4622,  1999, 26316, 19545,  7327,
         21615,  2678,   102,     0,     0,     0,     0,     0,     0,     0,
             0,     0,     0,     0,     0,     0,     0,     0,     0,     0,
             0,     0,     0,     0,     0,     0,     0,     0,     0,     0,
             0,     0,     0,     0,     0,     0,     0,     0,     0,     0,
             0,     0,     0,     0,     0,     0,     0,     0,     0,     0]])
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[49]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;targets&#39;</span><span class="p">][:</span><span class="mi">2</span><span class="p">])</span> <span class="c1"># target value of the first two rows from a batch of 16</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>tensor([1, 1])
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[50]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># We can confirm the above result from the training dataframe</span>
<span class="n">train_data</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[50]:</div>



<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>cleaned_title</th>
      <th>cleaned_text</th>
      <th>is_fake</th>
      <th>label</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>22216</th>
      <td>BREAKING GOP Chairman Grassley Has Had Enough...</td>
      <td>Donald Trump s White House is in chaos and the...</td>
      <td>1</td>
      <td>fake</td>
    </tr>
    <tr>
      <th>27917</th>
      <td>Failed GOP Candidates Remembered In Hilarious...</td>
      <td>Now that Donald Trump is the presumptive GOP n...</td>
      <td>1</td>
      <td>fake</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="3.2)-Modeling-using-BERT">3.2) Modeling using BERT<a class="anchor-link" href="#3.2)-Modeling-using-BERT">&#182;</a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>BERT Base-uncase pretrained model was used to train and validate the data.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[51]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">bert_model</span> <span class="o">=</span> <span class="n">BertModel</span><span class="o">.</span><span class="n">from_pretrained</span><span class="p">(</span><span class="n">PRE_TRAINED_MODEL_NAME</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>





 
 
<div id="3e1865bf-f1db-4ed4-84c7-653763059a57"></div>
<div class="output_subarea output_widget_view ">
<script type="text/javascript">
var element = $('#3e1865bf-f1db-4ed4-84c7-653763059a57');
</script>
<script type="application/vnd.jupyter.widget-view+json">
{"model_id": "e2ea6fdb088d4e9cb5fe39dc8a49ecf0", "version_major": 2, "version_minor": 0}
</script>
</div>

</div>

<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>
</pre>
</div>
</div>

<div class="output_area">

    <div class="prompt"></div>





 
 
<div id="1a888f9e-5291-4ea9-8f0b-937dc05097d8"></div>
<div class="output_subarea output_widget_view ">
<script type="text/javascript">
var element = $('#1a888f9e-5291-4ea9-8f0b-937dc05097d8');
</script>
<script type="application/vnd.jupyter.widget-view+json">
{"model_id": "ee9cf48038d44d10a743f1a68ffafb4f", "version_major": 2, "version_minor": 0}
</script>
</div>

</div>

<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[52]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># for the sample data</span>
<span class="n">last_hidden_state</span><span class="p">,</span> <span class="n">pooled_output</span> <span class="o">=</span> <span class="n">bert_model</span><span class="p">(</span>
  <span class="n">input_ids</span><span class="o">=</span><span class="n">encoding</span><span class="p">[</span><span class="s1">&#39;input_ids&#39;</span><span class="p">],</span>
  <span class="n">attention_mask</span><span class="o">=</span><span class="n">encoding</span><span class="p">[</span><span class="s1">&#39;attention_mask&#39;</span><span class="p">]</span>
<span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Last_hidden state in this case contians each token in a news and their corresponding hidden state of the last layer in the feedforward-networks whereas pooled_output is the summary of a news title on last_hidden_state.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[53]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">last_hidden_state</span><span class="o">.</span><span class="n">shape</span> <span class="c1">#  the number of hidden units in the feedforward-networks=768</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[53]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>torch.Size([1, 20, 768])</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[54]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">pooled_output</span><span class="o">.</span><span class="n">shape</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[54]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>torch.Size([1, 768])</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[55]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># to make classification</span>
<span class="k">class</span> <span class="nc">NewsClassifier</span><span class="p">(</span><span class="n">nn</span><span class="o">.</span><span class="n">Module</span><span class="p">):</span>
  <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">n_classes</span><span class="p">):</span> 
    <span class="nb">super</span><span class="p">(</span><span class="n">NewsClassifier</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">bert</span> <span class="o">=</span> <span class="n">BertModel</span><span class="o">.</span><span class="n">from_pretrained</span><span class="p">(</span><span class="n">PRE_TRAINED_MODEL_NAME</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">drop</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Dropout</span><span class="p">(</span><span class="n">p</span><span class="o">=</span><span class="mf">0.1</span><span class="p">)</span> <span class="c1"># set dropout probablity for regularization</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">out</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Linear</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">bert</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">hidden_size</span><span class="p">,</span> <span class="n">n_classes</span><span class="p">)</span>
  <span class="k">def</span> <span class="nf">forward</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">input_ids</span><span class="p">,</span> <span class="n">attention_mask</span><span class="p">):</span>
    <span class="n">_</span><span class="p">,</span> <span class="n">pooled_output</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">bert</span><span class="p">(</span>
      <span class="n">input_ids</span><span class="o">=</span><span class="n">input_ids</span><span class="p">,</span>
      <span class="n">attention_mask</span><span class="o">=</span><span class="n">attention_mask</span>
    <span class="p">)</span>
    <span class="n">output</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">pooled_output</span><span class="p">)</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">out</span><span class="p">(</span><span class="n">output</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[56]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1">#create classifier instance and move it to the GPU</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">NewsClassifier</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="c1"># we have an argument 2, because we have two classes, fake and real news labeles</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">device</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[57]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># move the batch of training data to GPU</span>
<span class="n">input_ids</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;input_ids&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">device</span><span class="p">)</span>
<span class="n">attention_mask</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;attention_mask&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">device</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">input_ids</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="c1"># batch size x seq length</span>
<span class="nb">print</span><span class="p">(</span><span class="n">attention_mask</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="c1"># batch size x seq length</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>torch.Size([16, 60])
torch.Size([16, 60])
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[58]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># predicted probabilities from the trained model using softmax function</span>
<span class="n">nn</span><span class="o">.</span><span class="n">functional</span><span class="o">.</span><span class="n">softmax</span><span class="p">(</span><span class="n">model</span><span class="p">(</span><span class="n">input_ids</span><span class="p">,</span> <span class="n">attention_mask</span><span class="p">),</span> <span class="n">dim</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[58]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>tensor([[0.3579, 0.6421],
        [0.3359, 0.6641],
        [0.3831, 0.6169],
        [0.2716, 0.7284],
        [0.3741, 0.6259],
        [0.3672, 0.6328],
        [0.3551, 0.6449],
        [0.3852, 0.6148],
        [0.4510, 0.5490],
        [0.4240, 0.5760],
        [0.3056, 0.6944],
        [0.3381, 0.6619],
        [0.4151, 0.5849],
        [0.3521, 0.6479],
        [0.3809, 0.6191],
        [0.3937, 0.6063]], device=&#39;cuda:0&#39;, grad_fn=&lt;SoftmaxBackward&gt;)</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="3.3)-Fine-tuning-BERT-model">3.3) Fine-tuning BERT model<a class="anchor-link" href="#3.3)-Fine-tuning-BERT-model">&#182;</a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Recommendations for fine-tuning by BERT's author:</p>
<ul>
<li>Batch size: 16, 32: increasing the batch size reduces the training time but gives lower accuracy</li>
<li>Learning rate (Adam): 5e-5, 3e-5, 2e-5</li>
<li>Number of epochs: 2, 3, 4</li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[59]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1">#Training </span>
<span class="n">EPOCHS</span> <span class="o">=</span> <span class="mi">4</span>
<span class="n">optimizer</span> <span class="o">=</span> <span class="n">AdamW</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">parameters</span><span class="p">(),</span> <span class="n">lr</span><span class="o">=</span><span class="mf">2e-5</span><span class="p">,</span> <span class="n">correct_bias</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">total_steps</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">train_data_loader</span><span class="p">)</span> <span class="o">*</span> <span class="n">EPOCHS</span>
<span class="n">scheduler</span> <span class="o">=</span> <span class="n">get_linear_schedule_with_warmup</span><span class="p">(</span>
  <span class="n">optimizer</span><span class="p">,</span>
  <span class="n">num_warmup_steps</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
  <span class="n">num_training_steps</span><span class="o">=</span><span class="n">total_steps</span>
  <span class="p">)</span>
<span class="n">loss_fn</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">CrossEntropyLoss</span><span class="p">()</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">device</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Cross entropy is the measure of the performance of classification obtained by comparing the actual probability with the  predicted probability(for more detail explanation please refer <a href="https://ml-cheatsheet.readthedocs.io/en/latest/loss_functions.html#:~:text=Cross-entropy%20loss%2C%20or%20log%20loss%2C%20measures%20the%20performance,the%20predicted%20probability%20diverges%20from%20the%20actual%20label.">here</a>)</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[60]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># helper function to train the model</span>
<span class="k">def</span> <span class="nf">train_epoch</span><span class="p">(</span> <span class="n">model</span><span class="p">,</span> <span class="n">data_loader</span><span class="p">,</span> <span class="n">loss_fn</span><span class="p">,</span> <span class="n">optimizer</span><span class="p">,</span> <span class="n">device</span><span class="p">,</span> <span class="n">scheduler</span><span class="p">,</span> <span class="n">n_examples</span><span class="p">):</span>
  <span class="n">model</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">train</span><span class="p">()</span>
  <span class="n">losses</span> <span class="o">=</span> <span class="p">[]</span>
  <span class="n">correct_predictions</span> <span class="o">=</span> <span class="mi">0</span> 
  <span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="n">data_loader</span><span class="p">:</span>
    <span class="n">input_ids</span> <span class="o">=</span> <span class="n">d</span><span class="p">[</span><span class="s2">&quot;input_ids&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">device</span><span class="p">)</span>
    <span class="n">attention_mask</span> <span class="o">=</span> <span class="n">d</span><span class="p">[</span><span class="s2">&quot;attention_mask&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">device</span><span class="p">)</span>
    <span class="n">targets</span> <span class="o">=</span> <span class="n">d</span><span class="p">[</span><span class="s2">&quot;targets&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">device</span><span class="p">)</span>
    <span class="n">outputs</span> <span class="o">=</span> <span class="n">model</span><span class="p">(</span>
      <span class="n">input_ids</span><span class="o">=</span><span class="n">input_ids</span><span class="p">,</span>
      <span class="n">attention_mask</span><span class="o">=</span><span class="n">attention_mask</span>
    <span class="p">)</span>
    <span class="n">_</span><span class="p">,</span> <span class="n">preds</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">outputs</span><span class="p">,</span> <span class="n">dim</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span> <span class="c1">#get the maximum probablity for prediction</span>
    <span class="n">loss</span> <span class="o">=</span> <span class="n">loss_fn</span><span class="p">(</span><span class="n">outputs</span><span class="p">,</span> <span class="n">targets</span><span class="p">)</span>
    <span class="n">correct_predictions</span> <span class="o">+=</span> <span class="n">torch</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">preds</span> <span class="o">==</span> <span class="n">targets</span><span class="p">)</span> <span class="c1"># number of correct predictions</span>
    <span class="n">losses</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">loss</span><span class="o">.</span><span class="n">item</span><span class="p">())</span>
    <span class="n">loss</span><span class="o">.</span><span class="n">backward</span><span class="p">()</span>
    <span class="n">nn</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">clip_grad_norm_</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">parameters</span><span class="p">(),</span> <span class="n">max_norm</span><span class="o">=</span><span class="mf">1.0</span><span class="p">)</span>
    <span class="n">optimizer</span><span class="o">.</span><span class="n">step</span><span class="p">()</span>
    <span class="n">scheduler</span><span class="o">.</span><span class="n">step</span><span class="p">()</span>
    <span class="n">optimizer</span><span class="o">.</span><span class="n">zero_grad</span><span class="p">()</span>
  <span class="k">return</span> <span class="n">correct_predictions</span><span class="o">.</span><span class="n">double</span><span class="p">()</span> <span class="o">/</span> <span class="n">n_examples</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">losses</span><span class="p">)</span>  <span class="c1"># accuracy, loss</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[61]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1">#helper function to evaluate the model</span>
<span class="k">def</span> <span class="nf">eval_model</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">data_loader</span><span class="p">,</span> <span class="n">loss_fn</span><span class="p">,</span> <span class="n">device</span><span class="p">,</span> <span class="n">n_examples</span><span class="p">):</span>
  <span class="n">model</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">eval</span><span class="p">()</span>
  <span class="n">losses</span> <span class="o">=</span> <span class="p">[]</span>
  <span class="n">correct_predictions</span> <span class="o">=</span> <span class="mi">0</span>
  <span class="k">with</span> <span class="n">torch</span><span class="o">.</span><span class="n">no_grad</span><span class="p">():</span>
    <span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="n">data_loader</span><span class="p">:</span>
      <span class="n">input_ids</span> <span class="o">=</span> <span class="n">d</span><span class="p">[</span><span class="s2">&quot;input_ids&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">device</span><span class="p">)</span>
      <span class="n">attention_mask</span> <span class="o">=</span> <span class="n">d</span><span class="p">[</span><span class="s2">&quot;attention_mask&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">device</span><span class="p">)</span>
      <span class="n">targets</span> <span class="o">=</span> <span class="n">d</span><span class="p">[</span><span class="s2">&quot;targets&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">device</span><span class="p">)</span>
      <span class="n">outputs</span> <span class="o">=</span> <span class="n">model</span><span class="p">(</span>
        <span class="n">input_ids</span><span class="o">=</span><span class="n">input_ids</span><span class="p">,</span>
        <span class="n">attention_mask</span><span class="o">=</span><span class="n">attention_mask</span>
      <span class="p">)</span>
      <span class="n">_</span><span class="p">,</span> <span class="n">preds</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">outputs</span><span class="p">,</span> <span class="n">dim</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span> <span class="c1"># take the maximum </span>
      <span class="n">loss</span> <span class="o">=</span> <span class="n">loss_fn</span><span class="p">(</span><span class="n">outputs</span><span class="p">,</span> <span class="n">targets</span><span class="p">)</span>
      <span class="n">correct_predictions</span> <span class="o">+=</span> <span class="n">torch</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">preds</span> <span class="o">==</span> <span class="n">targets</span><span class="p">)</span>
      <span class="n">losses</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">loss</span><span class="o">.</span><span class="n">item</span><span class="p">())</span>
  <span class="k">return</span> <span class="n">correct_predictions</span><span class="o">.</span><span class="n">double</span><span class="p">()</span> <span class="o">/</span> <span class="n">n_examples</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">losses</span><span class="p">)</span>  <span class="c1"># accuracy, loss </span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[62]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="o">%%time</span>
<span class="n">history</span> <span class="o">=</span> <span class="n">defaultdict</span><span class="p">(</span><span class="nb">list</span><span class="p">)</span> <span class="c1"># placeholder to store the history of training and validation performance</span>
<span class="n">best_accuracy</span> <span class="o">=</span> <span class="mi">0</span>
<span class="k">for</span> <span class="n">epoch</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">EPOCHS</span><span class="p">):</span>
  <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Epoch </span><span class="si">{</span><span class="n">epoch</span> <span class="o">+</span> <span class="mi">1</span><span class="si">}</span><span class="s1">/</span><span class="si">{</span><span class="n">EPOCHS</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
  <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;-&#39;</span> <span class="o">*</span> <span class="mi">10</span><span class="p">)</span>
  <span class="c1"># training performance</span>
  <span class="n">train_acc</span><span class="p">,</span> <span class="n">train_loss</span> <span class="o">=</span> <span class="n">train_epoch</span><span class="p">(</span><span class="n">model</span><span class="p">,</span><span class="n">train_data_loader</span><span class="p">,</span><span class="n">loss_fn</span><span class="p">,</span> <span class="n">optimizer</span><span class="p">,</span> <span class="n">device</span><span class="p">,</span> <span class="n">scheduler</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">train_data</span><span class="p">))</span>
  <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Train loss </span><span class="si">{</span><span class="n">train_loss</span><span class="si">}</span><span class="s1"> accuracy </span><span class="si">{</span><span class="n">train_acc</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
  
  <span class="c1"># validation performance </span>
  <span class="n">val_acc</span><span class="p">,</span> <span class="n">val_loss</span> <span class="o">=</span> <span class="n">eval_model</span><span class="p">(</span><span class="n">model</span><span class="p">,</span><span class="n">val_data_loader</span><span class="p">,</span> <span class="n">loss_fn</span><span class="p">,</span> <span class="n">device</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">validate_data</span><span class="p">))</span>
  <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Val   loss </span><span class="si">{</span><span class="n">val_loss</span><span class="si">}</span><span class="s1"> accuracy </span><span class="si">{</span><span class="n">val_acc</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
  <span class="nb">print</span><span class="p">()</span>

  <span class="n">history</span><span class="p">[</span><span class="s1">&#39;train_acc&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">train_acc</span><span class="p">)</span>
  <span class="n">history</span><span class="p">[</span><span class="s1">&#39;train_loss&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">train_loss</span><span class="p">)</span>
  <span class="n">history</span><span class="p">[</span><span class="s1">&#39;val_acc&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">val_acc</span><span class="p">)</span>
  <span class="n">history</span><span class="p">[</span><span class="s1">&#39;val_loss&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">val_loss</span><span class="p">)</span>
  <span class="k">if</span> <span class="n">val_acc</span> <span class="o">&gt;</span> <span class="n">best_accuracy</span><span class="p">:</span>
    <span class="n">torch</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">state_dict</span><span class="p">(),</span> <span class="s1">&#39;best_model_state.bin&#39;</span><span class="p">)</span> <span class="c1"># store the best model</span>
    <span class="n">best_accuracy</span> <span class="o">=</span> <span class="n">val_acc</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>Epoch 1/4
----------
Train loss 0.1296285122639349 accuracy 0.9602583683339697
Val   loss 0.09647069952418616 accuracy 0.9743132887899035

Epoch 2/4
----------
Train loss 0.0426868009054726 accuracy 0.9894043528064146
Val   loss 0.10733570853713174 accuracy 0.9775798069784707

Epoch 3/4
----------
Train loss 0.011607260809529509 accuracy 0.9973908616520301
Val   loss 0.12249030433684359 accuracy 0.9805493689680772

Epoch 4/4
----------
Train loss 0.003767455873490347 accuracy 0.9992045309914726
Val   loss 0.1310923327622118 accuracy 0.9809948032665182

CPU times: user 18min 32s, sys: 8min 20s, total: 26min 52s
Wall time: 27min 15s
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[63]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># plot the accuracy of training and validation data for different epoch</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">history</span><span class="p">[</span><span class="s1">&#39;train_acc&#39;</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;train accuracy&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">history</span><span class="p">[</span><span class="s1">&#39;val_acc&#39;</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;validation accuracy&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Training history&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Accuracy&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Epoch&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]);</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>




<div class="output_png output_subarea ">
<img src="data:image/png;base64,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8Md//MdMmDCBkSNHMn/+/IZ1hw4dyubNm9mwYQMjRozg8ssvZ+TIkXz+859nz549jbb15JNPMmXKFMaNG8dZZ53Fe++9B8CuXbu45JJLGD16NGPGjOHRRx8F4Oc//znjx49n7NixTJ+e+9rnefPmcdtttzW0OWrUKDZs2MCGDRs46aSTuPjiixk1ahRvvfUWV155JRMnTmTkyJHccMMNDessX76cz372s4wdO5bJkyezc+dOzjjjDF566aWGOqeddhovv/xyG/6m05WZU0NmXd1fPbmGte+07XfNnHxcH2740sgml3/ve99j9erVDTvBJUuW8OKLL7J69eqG2xfvvfdejj32WPbs2cOkSZM4//zz6dev30HtvPbaazz00EPcc889fPWrX+XRRx/loosuOqjOaaedxrJly5DEj3/8Y2655Rb+9m//lptuuomjjz6a3/72twBs3bqV6upqLr/8cpYuXcqwYcP44IPmBkL+KIb77ruPqVOnAnDzzTdz7LHHUltby/Tp01m1ahXDhw9n9uzZPPLII0yaNIkdO3bQvXt3Lr30Un76059yxx138Lvf/Y69e/cyduzY0n/RHcyJwMza1OTJkw+6h/3OO+/kscceA+Ctt97itddea5QIhg0bximnnALAhAkT2LBhQ6N2N27cyOzZs9m0aRP79+9v2MZzzz3Hww8/3FCvb9++PPnkk5xxxhkNdY499tgW4z7++OMbkgDAggULmD9/PjU1NWzatIm1a9ciiYEDBzJp0iQA+vTJPc45a9YsbrrpJm699Vbuvfde5syZ0+L2jiROBGZdRHOf3NtTz549G6aXLFnCc889x/PPP0+PHj2YNm0ae/fubbTOUUcd1TBdXl5e9NTQVVddxbe//W1mzpzJkiVLmDdvXqtjq6ioOOj8f34s+XG/8cYb3HbbbSxfvpy+ffsyZ86conHX69GjB2effTZPPPEECxYsYOXKla2OrSP5GoGZHbLevXuzc+fOJpdv376dvn370qNHD1555RWWLVt2yNvavn07gwYNAuC+++5rKD/77LO5++67G+a3bt3K1KlTWbp0KW+88QZAw6mhoUOH8uKLLwLw4osvNiwvtGPHDnr27MnRRx/Ne++9xzPPPAPASSedxKZNm1i+fDkAO3fubLgoftlll3H11VczadIk+vbte8j97AhOBGZ2yPr168epp57K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
"
>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="4)-Model-Evaluation">4) Model Evaluation<a class="anchor-link" href="#4)-Model-Evaluation">&#182;</a></h2><h3 id="4.1)-Validate-with-test-data">4.1) Validate with test data<a class="anchor-link" href="#4.1)-Validate-with-test-data">&#182;</a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[74]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># accuracy of the model for test data</span>
<span class="n">test_acc</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">eval_model</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">test_data_loader</span><span class="p">,</span><span class="n">loss_fn</span><span class="p">,</span> <span class="n">device</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">test_data</span><span class="p">))</span>
<span class="n">test_acc</span><span class="o">.</span><span class="n">item</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[74]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>0.9795100222717149</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The accuracy of the model for test data is very good and the model can be used for new data sets.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[66]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># A fuction to make prediction for new data. It returns the actual text,</span>
<span class="c1"># prediction , prediction probablity and real labeling</span>
<span class="k">def</span> <span class="nf">get_predictions</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">data_loader</span><span class="p">):</span>
  <span class="n">model</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">eval</span><span class="p">()</span>
  <span class="n">news_texts</span> <span class="o">=</span> <span class="p">[]</span>
  <span class="n">predictions</span> <span class="o">=</span> <span class="p">[]</span>
  <span class="n">prediction_probs</span> <span class="o">=</span> <span class="p">[]</span>
  <span class="n">real_values</span> <span class="o">=</span> <span class="p">[]</span>
  <span class="k">with</span> <span class="n">torch</span><span class="o">.</span><span class="n">no_grad</span><span class="p">():</span>
    <span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="n">data_loader</span><span class="p">:</span>
      <span class="n">texts</span> <span class="o">=</span> <span class="n">d</span><span class="p">[</span><span class="s2">&quot;row_text&quot;</span><span class="p">]</span>
      <span class="n">input_ids</span> <span class="o">=</span> <span class="n">d</span><span class="p">[</span><span class="s2">&quot;input_ids&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">device</span><span class="p">)</span>
      <span class="n">attention_mask</span> <span class="o">=</span> <span class="n">d</span><span class="p">[</span><span class="s2">&quot;attention_mask&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">device</span><span class="p">)</span>
      <span class="n">targets</span> <span class="o">=</span> <span class="n">d</span><span class="p">[</span><span class="s2">&quot;targets&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">device</span><span class="p">)</span>
      <span class="n">outputs</span> <span class="o">=</span> <span class="n">model</span><span class="p">(</span>
        <span class="n">input_ids</span><span class="o">=</span><span class="n">input_ids</span><span class="p">,</span>
        <span class="n">attention_mask</span><span class="o">=</span><span class="n">attention_mask</span>
      <span class="p">)</span>
      <span class="n">_</span><span class="p">,</span> <span class="n">preds</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">outputs</span><span class="p">,</span> <span class="n">dim</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
      
      <span class="n">news_texts</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">texts</span><span class="p">)</span>
      <span class="n">predictions</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">preds</span><span class="p">)</span>
      <span class="n">prediction_probs</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">outputs</span><span class="p">)</span>
      <span class="n">real_values</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">targets</span><span class="p">)</span>
  <span class="n">predictions</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">stack</span><span class="p">(</span><span class="n">predictions</span><span class="p">)</span><span class="o">.</span><span class="n">cpu</span><span class="p">()</span>
  <span class="n">prediction_probs</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">stack</span><span class="p">(</span><span class="n">prediction_probs</span><span class="p">)</span><span class="o">.</span><span class="n">cpu</span><span class="p">()</span>
  <span class="n">real_values</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">stack</span><span class="p">(</span><span class="n">real_values</span><span class="p">)</span><span class="o">.</span><span class="n">cpu</span><span class="p">()</span>
  <span class="k">return</span> <span class="n">news_texts</span><span class="p">,</span> <span class="n">predictions</span><span class="p">,</span> <span class="n">prediction_probs</span><span class="p">,</span> <span class="n">real_values</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[67]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">y_news_texts</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">,</span> <span class="n">y_pred_probs</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> <span class="n">get_predictions</span><span class="p">(</span>
  <span class="n">model</span><span class="p">,</span> <span class="n">test_data_loader</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[68]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># classification report for test data</span>
<span class="nb">print</span><span class="p">(</span><span class="n">classification_report</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">,</span> <span class="n">target_names</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;true&quot;</span><span class="p">,</span><span class="s2">&quot;fake&quot;</span><span class="p">]))</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>              precision    recall  f1-score   support

        true       0.98      0.98      0.98      3238
        fake       0.98      0.98      0.98      3497

    accuracy                           0.98      6735
   macro avg       0.98      0.98      0.98      6735
weighted avg       0.98      0.98      0.98      6735

</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[69]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># to display the confusion matrix</span>
<span class="k">def</span> <span class="nf">show_confusion_matrix</span><span class="p">(</span><span class="n">confusion_matrix</span><span class="p">):</span>
  <span class="n">hmap</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">heatmap</span><span class="p">(</span><span class="n">confusion_matrix</span><span class="p">,</span> <span class="n">annot</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">fmt</span><span class="o">=</span><span class="s2">&quot;d&quot;</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s2">&quot;Blues&quot;</span><span class="p">)</span>
  <span class="n">hmap</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">set_ticklabels</span><span class="p">(</span><span class="n">hmap</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">get_ticklabels</span><span class="p">(),</span> <span class="n">rotation</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">ha</span><span class="o">=</span><span class="s1">&#39;right&#39;</span><span class="p">)</span>
  <span class="n">hmap</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_ticklabels</span><span class="p">(</span><span class="n">hmap</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">get_ticklabels</span><span class="p">(),</span> <span class="n">rotation</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span> <span class="n">ha</span><span class="o">=</span><span class="s1">&#39;right&#39;</span><span class="p">)</span>
  <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;True lable&#39;</span><span class="p">)</span>
  <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Predicted label&#39;</span><span class="p">);</span>

<span class="n">cm</span> <span class="o">=</span> <span class="n">confusion_matrix</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">)</span>
<span class="n">df_cm</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">cm</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span> <span class="c1"># [0,1] is class name</span>
<span class="n">show_confusion_matrix</span><span class="p">(</span><span class="n">df_cm</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>




<div class="output_png output_subarea ">
<img src="data:image/png;base64,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
"
>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We can also see the examples from test data and their corresponding predictions.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[70]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">idx</span> <span class="o">=</span> <span class="mi">2</span> <span class="c1"># index</span>
<span class="n">class_names</span><span class="o">=</span> <span class="p">[</span><span class="s2">&quot;true&quot;</span><span class="p">,</span><span class="s2">&quot;fake&quot;</span><span class="p">]</span>
<span class="n">news_text_ttl</span> <span class="o">=</span> <span class="n">y_news_texts</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span> <span class="c1"># extract the news title with the given index</span>
<span class="n">true_label</span> <span class="o">=</span> <span class="n">y_test</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span>
<span class="n">pred_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;class_names&#39;</span><span class="p">:</span> <span class="n">class_names</span><span class="p">,</span> <span class="s1">&#39;values&#39;</span><span class="p">:</span> <span class="n">y_pred_probs</span><span class="p">[</span><span class="n">idx</span><span class="p">]})</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">wrap</span><span class="p">(</span><span class="n">news_text_ttl</span><span class="p">)))</span>
<span class="nb">print</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;True prediction: </span><span class="si">{</span><span class="n">class_names</span><span class="p">[</span><span class="n">true_label</span><span class="p">]</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>Lebanons grand mufti calls for national unity

True prediction: true
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[71]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">y_pred</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="c1">#prediction</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[71]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>tensor(0)</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[83]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">test_data</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">2</span><span class="p">,:]</span><span class="c1"># we can confirm the third row(index of two) from the test data </span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[83]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>cleaned_title        Lebanons grand mufti calls for national unity
cleaned_text     BEIRUT  Lebanon s grand mufti the top cleric f...
is_fake                                                          0
label                                                         true
Name: 15155, dtype: object</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="4.2-Use-the-model-to-classify-news-titles-from-Snopes-website">4.2 Use the model to classify news titles from Snopes website<a class="anchor-link" href="#4.2-Use-the-model-to-classify-news-titles-from-Snopes-website">&#182;</a></h3><p>Some news from <a href="https://www.snopes.com/">Snopes</a>, a fact checking website, were collected to test our model. It has news rated as false, true, mixed and so on. To test the model, archived news from the year 2016/2017 were collected from Snopes. This is because the data at hand was from 2015 to 2018. The current news might not be a good test as news in 2020 might be dominated by current issues such as covid-19. Thus, the older news was considered. A total of  twenty news titles, half of them labeled as fake and rest were true news, were used to test our model.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[72]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># news title and their corresponding labeling by Snopes</span>
<span class="n">snopes_data</span><span class="o">=</span> <span class="p">[</span><span class="s2">&quot;Is This James Earl Jones Dressed as Darth Vader&quot;</span><span class="p">,</span> 
<span class="s2">&quot;David Rockefeller&#39;s Sixth Heart Transplant Successful at Age 99&quot;</span><span class="p">,</span> 
<span class="s2">&quot;Did Bloomington Police Discover Over 200 Penises During Raid at a Mortician&#39;s Home?&quot;</span><span class="p">,</span> 
<span class="s2">&quot;Is the Trump Administration Price Gouging Puerto Rico Evacuees and Seizing Passports?&quot;</span><span class="p">,</span>
<span class="s2">&quot;2017 Tainted Halloween Candy Reports 11/5/2014&quot;</span><span class="p">,</span> 
<span class="s2">&quot;Did President Trump Say Pedophiles Will Get the Death Penalty?&quot;</span><span class="p">,</span> 
<span class="s2">&quot;Michelle Obama Never Placed Her Hand Over Her Heart During the National Anthem?&quot;</span><span class="p">,</span>
<span class="s2">&quot;Katy Perry Reveals Penchant for Cannibalism?&quot;</span> <span class="p">,</span>
<span class="s2">&quot;Is a Virginia Church Ripping Out an &#39;Offensive&#39; George Washington Plaque?&quot;</span><span class="p">,</span> 
<span class="s2">&quot;Were Scientists Caught Tampering with Raw Data to Exaggerate Sea Level Rise?&quot;</span><span class="p">,</span>
<span class="s2">&quot;Did Trump Retweet a Cartoon of a Train Hitting a CNN Reporter?&quot;</span><span class="p">,</span>
<span class="s2">&quot;Did Pipe-Bombing Suspect Cesar Sayoc Attend Donald Trump Rallies?&quot;</span><span class="p">,</span>
<span class="s2">&quot;Did President Trump’s Grandfather Beg the Government of Bavaria Not to Deport Him?&quot;</span><span class="p">,</span>
<span class="s2">&quot;Did Gun Violence Kill More People in U.S. in 9 Weeks than U.S. Combatants Died on D-Day?&quot;</span><span class="p">,</span>
 <span class="s2">&quot;Did the Florida Shooter’s Instagram Profile Picture Feature a ‘MAGA’ Hat?&quot;</span><span class="p">,</span>
<span class="s2">&quot;Wisconsin Department of Natural Resources Removes References to ‘Climate’ from Web Site&quot;</span><span class="p">,</span>
 <span class="s2">&quot;Hillary Clinton Referenced RFK Assassination as Reason to Continue 2008 Campaign&quot;</span><span class="p">,</span>
  <span class="s2">&quot;Did Richard Nixon Write a Letter Predicting Donald Trump’s Success in Politics?&quot;</span><span class="p">,</span> 
<span class="s2">&quot;Did a Twitter User Jeopardize Her NASA Internship by Insulting a Member of the National Space Council?&quot;</span><span class="p">,</span>
<span class="s2">&quot;Did WaPo Headline Call IS Leader al-Baghdadi an ‘Austere Religious Scholar’?&quot;</span><span class="p">]</span>  

<span class="n">label_actual</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;fake&quot;</span><span class="p">,</span> <span class="s2">&quot;fake&quot;</span><span class="p">,</span><span class="s2">&quot;fake&quot;</span><span class="p">,</span><span class="s2">&quot;fake&quot;</span><span class="p">,</span><span class="s2">&quot;fake&quot;</span><span class="p">,</span><span class="s2">&quot;mixed&quot;</span><span class="p">,</span> <span class="s2">&quot;fake&quot;</span><span class="p">,</span><span class="s2">&quot;fake&quot;</span><span class="p">,</span><span class="s2">&quot;mostly_false&quot;</span><span class="p">,</span><span class="s2">&quot;fake&quot;</span><span class="p">,</span><span class="s2">&quot;true&quot;</span><span class="p">,</span>
               <span class="s2">&quot;true&quot;</span><span class="p">,</span> <span class="s2">&quot;true&quot;</span><span class="p">,</span><span class="s2">&quot;true&quot;</span><span class="p">,</span><span class="s2">&quot;true&quot;</span><span class="p">,</span><span class="s2">&quot;true&quot;</span><span class="p">,</span><span class="s2">&quot;true&quot;</span><span class="p">,</span><span class="s2">&quot;true&quot;</span><span class="p">,</span><span class="s2">&quot;true&quot;</span><span class="p">,</span><span class="s2">&quot;true&quot;</span><span class="p">]</span> <span class="c1"># rated by Snopes</span>
<span class="n">label_adjusted</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;fake&quot;</span><span class="p">,</span> <span class="s2">&quot;fake&quot;</span><span class="p">,</span><span class="s2">&quot;fake&quot;</span><span class="p">,</span><span class="s2">&quot;fake&quot;</span><span class="p">,</span><span class="s2">&quot;fake&quot;</span><span class="p">,</span><span class="s2">&quot;fake&quot;</span><span class="p">,</span> <span class="s2">&quot;fake&quot;</span><span class="p">,</span><span class="s2">&quot;fake&quot;</span><span class="p">,</span><span class="s2">&quot;fake&quot;</span><span class="p">,</span><span class="s2">&quot;fake&quot;</span><span class="p">,</span><span class="s2">&quot;true&quot;</span><span class="p">,</span><span class="s2">&quot;true&quot;</span><span class="p">,</span>
                  <span class="s2">&quot;true&quot;</span><span class="p">,</span><span class="s2">&quot;true&quot;</span><span class="p">,</span><span class="s2">&quot;true&quot;</span><span class="p">,</span><span class="s2">&quot;true&quot;</span><span class="p">,</span><span class="s2">&quot;true&quot;</span><span class="p">,</span><span class="s2">&quot;true&quot;</span><span class="p">,</span><span class="s2">&quot;true&quot;</span><span class="p">,</span><span class="s2">&quot;true&quot;</span><span class="p">]</span>  <span class="c1"># adjusted to fake or true</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Clean the news in the same way as we cleaned the training data and then make prediction.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[84]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">snopes_pred</span><span class="o">=</span><span class="p">[]</span>
<span class="n">count_true_pred</span><span class="o">=</span><span class="mi">0</span>
<span class="k">for</span> <span class="n">pos</span><span class="p">,</span><span class="n">ttl</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">snopes_data</span><span class="p">):</span>
  <span class="n">ttl</span><span class="o">=</span> <span class="n">remove_pattern</span><span class="p">(</span><span class="n">ttl</span><span class="p">,</span> <span class="n">patterns</span><span class="p">)</span> <span class="c1"># clean the title</span>
  <span class="n">encoded_snopes</span> <span class="o">=</span> <span class="n">tokenizer</span><span class="o">.</span><span class="n">encode_plus</span><span class="p">(</span>
    <span class="n">ttl</span><span class="p">,</span>
    <span class="n">max_length</span><span class="o">=</span><span class="n">max_len</span><span class="p">,</span>
    <span class="n">add_special_tokens</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">return_token_type_ids</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">padding</span><span class="o">=</span><span class="s2">&quot;max_length&quot;</span><span class="p">,</span>
    <span class="n">return_attention_mask</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">truncation</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">return_tensors</span><span class="o">=</span><span class="s1">&#39;pt&#39;</span><span class="p">,</span>
  <span class="p">)</span>

  <span class="n">input_ids</span> <span class="o">=</span> <span class="n">encoded_snopes</span><span class="p">[</span><span class="s1">&#39;input_ids&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">device</span><span class="p">)</span>
  <span class="n">attention_mask</span> <span class="o">=</span> <span class="n">encoded_snopes</span><span class="p">[</span><span class="s1">&#39;attention_mask&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">device</span><span class="p">)</span>
  <span class="n">output</span> <span class="o">=</span> <span class="n">model</span><span class="p">(</span><span class="n">input_ids</span><span class="p">,</span> <span class="n">attention_mask</span><span class="p">)</span>
  <span class="n">_</span><span class="p">,</span> <span class="n">prediction</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">output</span><span class="p">,</span> <span class="n">dim</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
  
  <span class="n">pred_label</span><span class="o">=</span><span class="n">class_names</span><span class="p">[</span><span class="n">prediction</span><span class="p">]</span>  <span class="c1">#  prediction class</span>
  <span class="n">snopes_pred</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">pred_label</span><span class="p">)</span>

  <span class="c1"># compaire the predicted and actual class label</span>
  <span class="n">count_true_pred</span> <span class="o">+=</span> <span class="p">(</span><span class="n">pred_label</span><span class="o">==</span><span class="n">label_adjusted</span><span class="p">[</span><span class="n">pos</span><span class="p">])</span>
  
  
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Snopes news title: </span><span class="si">{</span><span class="n">snopes_data</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Prediction  : </span><span class="si">{</span><span class="n">snopes_pred</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;accuracy  : </span><span class="si">{</span><span class="n">count_true_pred</span><span class="o">/</span><span class="nb">len</span><span class="p">(</span><span class="n">snopes_data</span><span class="p">)</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>Snopes news title: [&#39;Is This James Earl Jones Dressed as Darth Vader&#39;, &#34;David Rockefeller&#39;s Sixth Heart Transplant Successful at Age 99&#34;, &#34;Did Bloomington Police Discover Over 200 Penises During Raid at a Mortician&#39;s Home?&#34;, &#39;Is the Trump Administration Price Gouging Puerto Rico Evacuees and Seizing Passports?&#39;, &#39;2017 Tainted Halloween Candy Reports 11/5/2014&#39;, &#39;Did President Trump Say Pedophiles Will Get the Death Penalty?&#39;, &#39;Michelle Obama Never Placed Her Hand Over Her Heart During the National Anthem?&#39;, &#39;Katy Perry Reveals Penchant for Cannibalism?&#39;, &#34;Is a Virginia Church Ripping Out an &#39;Offensive&#39; George Washington Plaque?&#34;, &#39;Were Scientists Caught Tampering with Raw Data to Exaggerate Sea Level Rise?&#39;, &#39;Did Trump Retweet a Cartoon of a Train Hitting a CNN Reporter?&#39;, &#39;Did Pipe-Bombing Suspect Cesar Sayoc Attend Donald Trump Rallies?&#39;, &#39;Did President Trump’s Grandfather Beg the Government of Bavaria Not to Deport Him?&#39;, &#39;Did Gun Violence Kill More People in U.S. in 9 Weeks than U.S. Combatants Died on D-Day?&#39;, &#39;Did the Florida Shooter’s Instagram Profile Picture Feature a ‘MAGA’ Hat?&#39;, &#39;Wisconsin Department of Natural Resources Removes References to ‘Climate’ from Web Site&#39;, &#39;Hillary Clinton Referenced RFK Assassination as Reason to Continue 2008 Campaign&#39;, &#39;Did Richard Nixon Write a Letter Predicting Donald Trump’s Success in Politics?&#39;, &#39;Did a Twitter User Jeopardize Her NASA Internship by Insulting a Member of the National Space Council?&#39;, &#39;Did WaPo Headline Call IS Leader al-Baghdadi an ‘Austere Religious Scholar’?&#39;]
Prediction  : [&#39;fake&#39;, &#39;true&#39;, &#39;fake&#39;, &#39;fake&#39;, &#39;fake&#39;, &#39;fake&#39;, &#39;fake&#39;, &#39;fake&#39;, &#39;fake&#39;, &#39;fake&#39;, &#39;fake&#39;, &#39;fake&#39;, &#39;fake&#39;, &#39;fake&#39;, &#39;fake&#39;, &#39;true&#39;, &#39;true&#39;, &#39;fake&#39;, &#39;fake&#39;, &#39;fake&#39;]
accuracy  : 0.55
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Summary">Summary<a class="anchor-link" href="#Summary">&#182;</a></h2><p>The BERT model has better accuracy than other models done by word count, tfidf and word2vec (available in my <a href="https://github.com/mgayalew/SpringBoard/blob/master/Capstone%20project_2/Capstone%20project_2%20modeling%20and%20testing.ipynb">github repository</a>). The accuracy of test data using the BERT model was approximately 0.98 whereas the accuracies obtained by other models were between 0.93 and 0.94. Though due to the capacity limit, we could not be able to predict using news text, we expect the same better performance than the corresponding models. This is left for further experiment.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Reference-:">Reference :<a class="anchor-link" href="#Reference-:">&#182;</a></h2><ul>
<li><a href="https://arxiv.org/pdf/1810.04805.pdf">BERT original paper</a> </li>
<li><a href="https://www.kaggle.com/clmentbisaillon/fake-and-real-news-dataset">Input data(fake and real news)</a> </li>
<li><a href="https://huggingface.co/transformers/">Transformers library documentation</a> </li>
<li><a href="https://www.curiousily.com/posts/sentiment-analysis-with-bert-and-hugging-face-using-pytorch-and-python/">Reference to implement transformer library</a></li>
<li><a href="https://ml-cheatsheet.readthedocs.io/en/latest/loss_functions.html#:~:text=Cross-entropy%20loss%2C%20or%20log%20loss%2C%20measures%20the%20performance,the%20predicted%20probability%20diverges%20from%20the%20actual%20label.">Cross entropy loss</a> </li>
<li><a href="https://www.snopes.com/">Snopes website</a></li>
<li><a href="https://colab.research.google.com/notebooks/intro.ipynb">Google Colaboratory</a></li>
<li><a href="https://towardsdatascience.com/importing-data-to-google-colab-the-clean-way-5ceef9e9e3c8"> Ways to get data into colab</a></li>
<li><a href="https://huggingface.co/transformers/main_classes/tokenizer.html#transformers.PreTrainedTokenizer">Documentation for pretrained tokenizer</a></li>
</ul>

</div>
</div>
</div>
    </div>
  </div>
  
  <!--comment line starst here -->
<div id="disqus_thread"></div>
<script>
/**
*  RECOMMENDED CONFIGURATION VARIABLES: EDIT AND UNCOMMENT THE SECTION BELOW TO INSERT DYNAMIC VALUES FROM YOUR PLATFORM OR CMS.
*  LEARN WHY DEFINING THESE VARIABLES IS IMPORTANT: https://disqus.com/admin/universalcode/#configuration-variables*/
var disqus_config = function () {
this.page.url = 'http://datascienceandme.com/NewsClassificationWithBERT.html';  // Replace PAGE_URL with your page's canonical URL variable
//this.page.identifier = PAGE_IDENTIFIER; // Replace PAGE_IDENTIFIER with your page's unique identifier variable
this.page.title = 'News Classification with BERT'
};
(function() { // DON'T EDIT BELOW THIS LINE
var d = document, s = d.createElement('script');
s.src = '//datascienceandme-com-1.disqus.com/embed.js';
s.setAttribute('data-timestamp', +new Date());
(d.head || d.body).appendChild(s);
})();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<script id="dsq-count-scr" src="//datascienceandme-com-1.disqus.com/count.js" async></script>                                


	<!-- Page footer rows -->
	<footer>
	  <p>&#169; 2016 Muluemebet G. Ayalew</p>
	</footer>
  
  
</body>

 

<script type="application/vnd.jupyter.widget-state+json">
{"1778a0c621c649328ab2217091ad923f": {"model_module": "@jupyter-widgets/controls", "model_name": "DescriptionStyleModel", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "DescriptionStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "StyleView", "description_width": ""}}, "31d46ce498bb4cf59e39a8489605f07c": {"model_module": "@jupyter-widgets/controls", "model_name": "ProgressStyleModel", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "ProgressStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "StyleView", "bar_color": null, "description_width": "initial"}}, "35596edfaeec47dc8248f42474d736cc": {"model_module": "@jupyter-widgets/controls", "model_name": "HTMLModel", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "HTMLModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "HTMLView", "description": "", "description_tooltip": null, "layout": "IPY_MODEL_8e8cbbaca7194cb791a00ba20e7fd110", "placeholder": "\u200b", "style": "IPY_MODEL_1778a0c621c649328ab2217091ad923f", "value": " 433/433 [00:06&lt;00:00, 63.5B/s]"}}, "38ec83e9453f49158534396e67ed95e6": {"model_module": "@jupyter-widgets/controls", "model_name": "ProgressStyleModel", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "ProgressStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "StyleView", "bar_color": null, "description_width": "initial"}}, "3cd92065e2654e90915dc34ec56a8cbf": {"model_module": "@jupyter-widgets/base", "model_name": "LayoutModel", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "491c29ff44d94aeaa9bf010b3983ff1c": {"model_module": "@jupyter-widgets/controls", "model_name": "HTMLModel", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "HTMLModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "HTMLView", "description": "", "description_tooltip": null, "layout": "IPY_MODEL_6b5b897197b14288a1512b386b5670f7", "placeholder": "\u200b", "style": "IPY_MODEL_541d24fd1f574d3c927a0f1c3a764879", "value": " 232k/232k [00:00&lt;00:00, 581kB/s]"}}, "4bc2615083004e1688d0df57d2c616c6": {"model_module": "@jupyter-widgets/controls", "model_name": "ProgressStyleModel", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "ProgressStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "StyleView", "bar_color": null, "description_width": "initial"}}, "4e4ed2a5ab5144c5a6620d769468c3e5": {"model_module": "@jupyter-widgets/controls", "model_name": "HTMLModel", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "HTMLModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "HTMLView", "description": "", "description_tooltip": null, "layout": "IPY_MODEL_840b0be6540449a0b7b6980851832d43", "placeholder": "\u200b", "style": "IPY_MODEL_6a2cd208d45945da837b4b60e12c5485", "value": " 440M/440M [00:06&lt;00:00, 65.8MB/s]"}}, "52449af9626c407bbed3b0a80b793fa8": {"model_module": "@jupyter-widgets/base", "model_name": "LayoutModel", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "541d24fd1f574d3c927a0f1c3a764879": {"model_module": "@jupyter-widgets/controls", "model_name": "DescriptionStyleModel", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "DescriptionStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "StyleView", "description_width": ""}}, "62fc827cbc814e8aa89b19adb4cc852e": {"model_module": "@jupyter-widgets/controls", "model_name": "HBoxModel", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "HBoxModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "HBoxView", "box_style": "", "children": ["IPY_MODEL_c0a7b9060d4a4e82b54dcd902200d3df", "IPY_MODEL_491c29ff44d94aeaa9bf010b3983ff1c"], "layout": "IPY_MODEL_ec47f8ba75c3407ab905014e5bd17541"}}, "6a2cd208d45945da837b4b60e12c5485": {"model_module": "@jupyter-widgets/controls", "model_name": "DescriptionStyleModel", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "DescriptionStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "StyleView", "description_width": ""}}, "6b5b897197b14288a1512b386b5670f7": {"model_module": "@jupyter-widgets/base", "model_name": "LayoutModel", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "840b0be6540449a0b7b6980851832d43": {"model_module": "@jupyter-widgets/base", "model_name": "LayoutModel", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "853bfad0106347599726b5e1b1222b0f": {"model_module": "@jupyter-widgets/controls", "model_name": "FloatProgressModel", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "FloatProgressModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "ProgressView", "bar_style": "success", "description": "Downloading: 100%", "description_tooltip": null, "layout": "IPY_MODEL_d8f52162946b4355b613a69fdd17c885", "max": 440473133, "min": 0, "orientation": "horizontal", "style": "IPY_MODEL_31d46ce498bb4cf59e39a8489605f07c", "value": 440473133}}, "8e8cbbaca7194cb791a00ba20e7fd110": {"model_module": "@jupyter-widgets/base", "model_name": "LayoutModel", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "b59d3ee00c844af8ba24d4fe9000483d": {"model_module": "@jupyter-widgets/base", "model_name": "LayoutModel", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "c0a7b9060d4a4e82b54dcd902200d3df": {"model_module": "@jupyter-widgets/controls", "model_name": "FloatProgressModel", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "FloatProgressModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "ProgressView", "bar_style": "success", "description": "Downloading: 100%", "description_tooltip": null, "layout": "IPY_MODEL_eff703034a7d4f3cac55eef3ba74a056", "max": 231508, "min": 0, "orientation": "horizontal", "style": "IPY_MODEL_4bc2615083004e1688d0df57d2c616c6", "value": 231508}}, "d8f52162946b4355b613a69fdd17c885": {"model_module": "@jupyter-widgets/base", "model_name": "LayoutModel", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "e207eaa5374b43c79c396e4f99b3e6a1": {"model_module": "@jupyter-widgets/controls", "model_name": "FloatProgressModel", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "FloatProgressModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "ProgressView", "bar_style": "success", "description": "Downloading: 100%", "description_tooltip": null, "layout": "IPY_MODEL_3cd92065e2654e90915dc34ec56a8cbf", "max": 433, "min": 0, "orientation": "horizontal", "style": "IPY_MODEL_38ec83e9453f49158534396e67ed95e6", "value": 433}}, "e2ea6fdb088d4e9cb5fe39dc8a49ecf0": {"model_module": "@jupyter-widgets/controls", "model_name": "HBoxModel", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "HBoxModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "HBoxView", "box_style": "", "children": ["IPY_MODEL_e207eaa5374b43c79c396e4f99b3e6a1", "IPY_MODEL_35596edfaeec47dc8248f42474d736cc"], "layout": "IPY_MODEL_52449af9626c407bbed3b0a80b793fa8"}}, "ec47f8ba75c3407ab905014e5bd17541": {"model_module": "@jupyter-widgets/base", "model_name": "LayoutModel", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "ee9cf48038d44d10a743f1a68ffafb4f": {"model_module": "@jupyter-widgets/controls", "model_name": "HBoxModel", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "HBoxModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "HBoxView", "box_style": "", "children": ["IPY_MODEL_853bfad0106347599726b5e1b1222b0f", "IPY_MODEL_4e4ed2a5ab5144c5a6620d769468c3e5"], "layout": "IPY_MODEL_b59d3ee00c844af8ba24d4fe9000483d"}}, "eff703034a7d4f3cac55eef3ba74a056": {"model_module": "@jupyter-widgets/base", "model_name": "LayoutModel", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}}
</script>


</html>
