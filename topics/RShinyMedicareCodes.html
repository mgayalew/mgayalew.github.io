<!DOCTYPE html>
<html lang="en">
	<head>
	<meta charset="UTF-8">
	<title>Muluemebet G Ayalew</title>
	<link rel="stylesheet" type="text/css" href="../stylesheets/style-RShinyMedicare.css">
	<link rel="stylesheet" type="text/css" href="../stylesheets/style-headerfooterside.css">
	<link rel="stylesheet" type="text/css" href="../stylesheets/style-bodyandothers.css">

<script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.1.10/require.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>


<!-- Custom stylesheet, it must be in the same directory as the html file -->
<link rel="stylesheet" href="custom.css">

<!-- Loading mathjax macro -->
<!-- Load mathjax -->
    <script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS_HTML"></script>
    <!-- MathJax configuration -->
    <script type="text/x-mathjax-config">
    MathJax.Hub.Config({
        tex2jax: {
            inlineMath: [ ['$','$'], ["\\(","\\)"] ],
            displayMath: [ ['$$','$$'], ["\\[","\\]"] ],
            processEscapes: true,
            processEnvironments: true
        },
        // Center justify equations in code and markdown cells. Elsewhere
        // we use CSS to left justify single line equations in code cells.
        displayAlign: 'center',
        "HTML-CSS": {
            styles: {'.MathJax_Display': {"margin": 0}},
            linebreaks: { automatic: true }
        }
    });
    </script>
    <!-- End of mathjax configuration --></head>
	
	
<body>

	<!-- Page header rows -->
	<ul class="ul-first-nav-bar">
		<li class="li-first-nav-bar"><a class="a-webpage-name active">DataScienceAndMe.com</a></li>
	</ul>
	<ul class="ul-first-nav-bar">
		<li class="li-first-nav-bar"><a class="a-mt-header-name active">Muluemebet G Ayalew Page </a></li>
		<li class="li-first-nav-bar"><a class="active">&#9742; 518-445-5698 </a></li>
		<li class="li-first-nav-bar"><a class="active" href="mailto:mg.ayalew@gmail.com?Subject=">&#9993; mg.ayalew@gmail.com</a></li>
		<li class="li-first-nav-bar"><a class="active" href="../documents/ayalew_resume.pdf">Resume</a></li>
		<li class="li-first-nav-bar"><a class="active" href="https://www.linkedin.com/in/muluemebet-g-ayalew-8a91a310" target="_blank"><img src="../images/linkedin_logo.png" alt="Picture" style="width:50px;height:18px; align: left; vertical-align: middle;"></a></li>
		<li class="li-first-nav-bar"><a class="active" href="https://github.com/mgayalew" target="_blank"><img src="../images/github_logo.jpg" alt="Picture" style="width:25px;height:25px; align: left; vertical-align: middle;"></a></li>
	</ul>
	<ul class="ul-second-nav-bar">
		<li class="li-second-nav-bar"><a class="active" href="../index.html">Home</a></li>  
		<li class="li-second-nav-bar"><a href="../about.html">About</a></li>  
		<li class="li-second-nav-bar"><a href="../projects.html">Projects</a></li>  
		<li class="li-second-nav-bar"><a href="../education.html">Education</a></li>  
		<li class="li-second-nav-bar"><a href="../certificateskill.html">Data Science Certificates & Skills</a></li> 

	</ul> 


<!-- Header end here -->


  <div tabindex="-1" id="notebook" class="border-box-sizing">
    <div class="container" id="notebook-container">

<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="R-Shiny-Apps:-Exploring-Medicare-Spending-Across-Providers-(R-Codes)">R Shiny Apps: Exploring Medicare Spending Across Providers (R Codes)<a class="anchor-link" href="#R-Shiny-Apps:-Exploring-Medicare-Spending-Across-Providers-(R-Codes)">&#182;</a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>In this blog I developed an <a href="https://mgayalew.shinyapps.io/program/">R shiny</a> apps that explores the differences on average medicare spending across providers by period and claim type within each state. You can read the data description and explore the apps <a href="https://mgayalew.shinyapps.io/program/" target="_blank">here</a>. </p>
<p>The R codes used to develop the interactive R-shiny apps is provided in two separate components: (1) user-interface script (ui.r) that controls the layout and appearance of the apps, and (2) server script (server.r) that contains R program instructions, such as calling the data, loading the package and creating the interactive apps. The files along with the data used for this app can also be downloaded from <a href="https://github.com/mgayalew/RShinyMedicareApp" target="_blank">my github page</a>.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="ui.r-code"><code>ui.r code</code><a class="anchor-link" href="#ui.r-code">&#182;</a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-r"><pre><span></span>

fluidPage<span class="p">(</span>
  h3<span class="p">(</span><span class="s">&quot;Exploring Average Medicare Hospital Spending by Period and Claim Type&quot;</span><span class="p">),</span>
  h4<span class="p">(</span><span class="s">&quot;Data Description&quot;</span><span class="p">),</span>
  p<span class="p">(</span><span class="s">&quot;Medical spending per beneficiary data and data description was obtained from&quot;</span><span class="p">,</span> a<span class="p">(</span><span class="s">&quot;Data.Medicare.gov&quot;</span><span class="p">,</span> href<span class="o">=</span><span class="s">&quot;https://data.medicare.gov/&quot;</span><span class="p">),</span><span class="s">&quot;. The data displayed here shows average spending levels during hospitalsâ€™ Medicare Spending per Beneficiary (MSPB) episodes. An MSPB episode includes all Medicare Part A and Part B claims paid during the period from 3 days prior to a hospital admission through 30 days after discharge. These average Medicare payment amounts have been price-standardized to remove the effect of geographic payment differences and add-on payments for indirect medical education (IME) and disproportionate share hospitals (DSH).&quot;</span><span class="p">),</span>
  h4<span class="p">(</span><span class="s">&quot;Purpose of the Apps&quot;</span><span class="p">),</span>
  p<span class="p">(</span><span class="s">&quot;The aim of this shiny apps is to explore the differences on average spending across providers by period and claim type within states. The average spending was compared across states in&quot;</span><span class="p">,</span> a<span class="p">(</span><span class="s">&quot;another blog&quot;</span><span class="p">,</span> href<span class="o">=</span><span class="s">&quot;http://datascienceandme.com/topics/medicareAcrossStates.html&quot;</span><span class="p">)),</span>
  p<span class="p">(</span><span class="s">&quot;The following scatter plot helps to visualize Medicare average spending per episode among different providers. You can explore average spending within each state for a given period and type of claim by selecting the state from the drop-down box, and period and claim type from the radio buttons. Summary statistics of average spending for a given selection is provided on the top of the application, followed by scatter plot of average spending. Provider with highest average spending are listed under the scatter plot. You can see the name of provider and the average spending by hovering the cursor on each observation. In summary the top ten highest average spending was for inpatient claims during index hospital admission in the state of Texas (3 providers), Ohio, Nebraska, Indiana, Kansas (each 1 provider) and Oklahoma (2 provider).&quot;</span><span class="p">),</span>
p<span class="p">(</span><span class="s">&quot;Note that if a given period and type of claim for a given state have no data, no observation appears on the scatter plot. &quot;</span><span class="p">),</span>
  fluidRow<span class="p">(</span>
    column<span class="p">(</span><span class="m">3</span><span class="p">,</span>
      wellPanel<span class="p">(</span>
        selectInput<span class="p">(</span><span class="s">&quot;state&quot;</span><span class="p">,</span> <span class="s">&quot;USA States:&quot;</span><span class="p">,</span> <span class="kt">c</span><span class="p">(</span><span class="s">&quot;AK&quot;</span><span class="p">,</span><span class="s">&quot;AL&quot;</span><span class="p">,</span> <span class="s">&quot;AR&quot;</span><span class="p">,</span> <span class="s">&quot;AZ&quot;</span><span class="p">,</span> <span class="s">&quot;CA&quot;</span><span class="p">,</span> <span class="s">&quot;CO&quot;</span><span class="p">,</span> <span class="s">&quot;CT&quot;</span><span class="p">,</span> <span class="s">&quot;DC&quot;</span><span class="p">,</span> <span class="s">&quot;DE&quot;</span><span class="p">,</span> <span class="s">&quot;FL&quot;</span><span class="p">,</span> <span class="s">&quot;GA&quot;</span><span class="p">,</span> <span class="s">&quot;HI&quot;</span><span class="p">,</span> <span class="s">&quot;IA&quot;</span><span class="p">,</span> <span class="s">&quot;ID&quot;</span><span class="p">,</span> <span class="s">&quot;IL&quot;</span><span class="p">,</span> <span class="s">&quot;IN&quot;</span><span class="p">,</span> <span class="s">&quot;KS&quot;</span><span class="p">,</span> <span class="s">&quot;KY&quot;</span><span class="p">,</span> <span class="s">&quot;LA&quot;</span><span class="p">,</span> <span class="s">&quot;MA&quot;</span><span class="p">,</span> <span class="s">&quot;ME&quot;</span><span class="p">,</span> <span class="s">&quot;MI&quot;</span><span class="p">,</span> <span class="s">&quot;MN&quot;</span><span class="p">,</span> <span class="s">&quot;MO&quot;</span><span class="p">,</span> <span class="s">&quot;MS&quot;</span><span class="p">,</span> <span class="s">&quot;MT&quot;</span><span class="p">,</span> <span class="s">&quot;NC&quot;</span><span class="p">,</span> <span class="s">&quot;ND&quot;</span><span class="p">,</span> <span class="s">&quot;NE&quot;</span><span class="p">,</span> <span class="s">&quot;NH&quot;</span><span class="p">,</span> <span class="s">&quot;NJ&quot;</span><span class="p">,</span> <span class="s">&quot;NM&quot;</span><span class="p">,</span> <span class="s">&quot;NV&quot;</span><span class="p">,</span> <span class="s">&quot;NY&quot;</span><span class="p">,</span> <span class="s">&quot;OH&quot;</span><span class="p">,</span> <span class="s">&quot;OK&quot;</span><span class="p">,</span> <span class="s">&quot;OR&quot;</span><span class="p">,</span> <span class="s">&quot;PA&quot;</span><span class="p">,</span> <span class="s">&quot;RI&quot;</span><span class="p">,</span> <span class="s">&quot;SC&quot;</span><span class="p">,</span> <span class="s">&quot;SD&quot;</span><span class="p">,</span> <span class="s">&quot;TN&quot;</span><span class="p">,</span> <span class="s">&quot;TX&quot;</span><span class="p">,</span> <span class="s">&quot;UT&quot;</span><span class="p">,</span> <span class="s">&quot;VA&quot;</span><span class="p">,</span> <span class="s">&quot;VT&quot;</span><span class="p">,</span> <span class="s">&quot;WA&quot;</span><span class="p">,</span> <span class="s">&quot;WI&quot;</span><span class="p">,</span> <span class="s">&quot;WV&quot;</span><span class="p">,</span> <span class="s">&quot;WY&quot;</span><span class="p">)),</span>
        radioButtons<span class="p">(</span><span class="s">&quot;period&quot;</span><span class="p">,</span> <span class="s">&quot;Period: &quot;</span><span class="p">,</span> <span class="kt">c</span><span class="p">(</span><span class="s">&quot;During Index Hospital Admission&quot;</span><span class="p">,</span> <span class="s">&quot;30 days After Discharge from Index Hospital Admission&quot;</span><span class="p">,</span> <span class="s">&quot;1 to 3 days Prior to Index Hospital Admission&quot;</span><span class="p">)),</span>
        radioButtons<span class="p">(</span><span class="s">&quot;clmType&quot;</span><span class="p">,</span> <span class="s">&quot;Claim Type: &quot;</span><span class="p">,</span> <span class="kt">c</span><span class="p">(</span><span class="s">&quot;Inpatient&quot;</span><span class="p">,</span> <span class="s">&quot;Skilled Nursing Facility&quot;</span><span class="p">,</span> <span class="s">&quot;Durable Medical Equipment Carrier&quot;</span><span class="p">,</span> <span class="s">&quot;Home Health Agency&quot;</span><span class="p">,</span> <span class="s">&quot;Hospice&quot;</span><span class="p">,</span> <span class="s">&quot;Outpatient&quot;</span><span class="p">))</span>
      <span class="p">)</span>
    <span class="p">),</span>
    column<span class="p">(</span><span class="m">9</span><span class="p">,</span>
      verbatimTextOutput<span class="p">(</span><span class="s">&quot;smryTable&quot;</span><span class="p">),</span>
      ggvisOutput<span class="p">(</span><span class="s">&quot;sctrPlot&quot;</span><span class="p">),</span>
      wellPanel<span class="p">(</span>
        span<span class="p">(</span>h4<span class="p">(</span><span class="s">&quot;Total number of Providers:&quot;</span><span class="p">),</span>  textOutput<span class="p">(</span><span class="s">&quot;nmbrProviders&quot;</span><span class="p">)</span> <span class="p">),</span>
        span<span class="p">(</span>h4<span class="p">(</span><span class="s">&quot;Top 10 Providers with highest average spending in decreasing order:&quot;</span><span class="p">),</span>  textOutput<span class="p">(</span><span class="s">&quot;topProviders&quot;</span><span class="p">)</span> <span class="p">)</span>
        <span class="p">)</span>
    <span class="p">)</span>
  <span class="p">)</span>
<span class="p">)</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="server.r-code"><code>server.r code</code><a class="anchor-link" href="#server.r-code">&#182;</a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-r"><pre><span></span><span class="kn">library</span><span class="p">(</span>shiny<span class="p">)</span>
<span class="kn">library</span><span class="p">(</span>ggvis<span class="p">)</span>
<span class="kn">library</span><span class="p">(</span>dplyr<span class="p">)</span>
<span class="kn">library</span><span class="p">(</span>stargazer<span class="p">)</span>


<span class="c1"># Import Medicare spending *.CSV dataset</span>
mdClm <span class="o">&lt;-</span> read.csv<span class="p">(</span><span class="kp">paste</span><span class="p">(</span><span class="s">&quot;./data/Medicare Hospital Spending by Claim.csv&quot;</span><span class="p">,</span> sep<span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">))</span>
mdClm <span class="o">&lt;-</span> arrange<span class="p">(</span>mdClm<span class="p">,</span> State<span class="p">,</span> Hospital_Name<span class="p">)</span>
mdClm<span class="o">$</span>ID <span class="o">&lt;-</span> <span class="kp">seq</span><span class="p">(</span><span class="m">1</span><span class="p">,</span><span class="kp">length</span><span class="p">(</span>mdClm<span class="o">$</span>Hospital_Name<span class="p">),</span><span class="m">1</span><span class="p">)</span>
mdClm<span class="o">$</span>prvdrSpndng <span class="o">&lt;-</span>  <span class="kp">paste</span><span class="p">(</span><span class="kp">paste0</span><span class="p">(</span>mdClm<span class="o">$</span>Hospital_Name<span class="p">,</span><span class="s">&quot;: &quot;</span><span class="p">),</span> <span class="kp">paste0</span><span class="p">(</span><span class="s">&quot;$&quot;</span><span class="p">,</span> <span class="kp">format</span><span class="p">(</span>mdClm<span class="o">$</span>Avg_Spending_Per_Episode_Hospital<span class="p">,</span> big.mark <span class="o">=</span> <span class="s">&quot;,&quot;</span><span class="p">,</span> scientific <span class="o">=</span> <span class="kc">FALSE</span><span class="p">),</span><span class="s">&quot;;&quot;</span><span class="p">))</span>
mdClm <span class="o">&lt;-</span>  mdClm <span class="o">%&gt;%</span>
            filter<span class="p">(</span>Period <span class="o">!=</span> <span class="s">&quot;Complete Episode&quot;</span> <span class="o">&amp;</span> Claim_Type <span class="o">!=</span> <span class="s">&quot;Total&quot;</span><span class="p">)</span>
mdClm <span class="o">&lt;-</span> rename<span class="p">(</span>mdClm<span class="p">,</span> AvgSpndngHsptl<span class="o">=</span>Avg_Spending_Per_Episode_Hospital<span class="p">,</span> AvgSpndngState<span class="o">=</span>Avg_Spending_Per_Episode_State<span class="p">,</span> AvgSpndngNtn<span class="o">=</span>Avg_Spending_Per_Episode_Nation<span class="p">)</span> 


<span class="kr">function</span><span class="p">(</span>input<span class="p">,</span> output<span class="p">,</span> session<span class="p">)</span> <span class="p">{</span>

  mdClmFnl <span class="o">&lt;-</span> reactive<span class="p">({</span>
    <span class="c1"># Apply filters</span>
        mdClm <span class="o">%&gt;%</span>
        filter<span class="p">(</span>State <span class="o">==</span> input<span class="o">$</span>state<span class="p">,</span> Period <span class="o">==</span> input<span class="o">$</span>period<span class="p">,</span> Claim_Type <span class="o">==</span> input<span class="o">$</span>clmType<span class="p">)</span> 
  <span class="p">})</span>

  
  
  <span class="c1"># Function for generating tooltip text</span>
  mdclm_tooltip <span class="o">&lt;-</span> <span class="kr">function</span><span class="p">(</span>x<span class="p">)</span> <span class="p">{</span>
    <span class="kr">if</span> <span class="p">(</span><span class="kp">is.null</span><span class="p">(</span>x<span class="p">))</span> <span class="kr">return</span><span class="p">(</span><span class="kc">NULL</span><span class="p">)</span>
    <span class="kr">if</span> <span class="p">(</span><span class="kp">is.null</span><span class="p">(</span>x<span class="o">$</span>ID<span class="p">))</span> <span class="kr">return</span><span class="p">(</span><span class="kc">NULL</span><span class="p">)</span>

    <span class="c1"># Pick out the average spending with this ID</span>
    all_mdClmFnl <span class="o">&lt;-</span> isolate<span class="p">(</span>mdClmFnl<span class="p">())</span>
    mdClms <span class="o">&lt;-</span> all_mdClmFnl<span class="p">[</span>all_mdClmFnl<span class="o">$</span>ID <span class="o">==</span> x<span class="o">$</span>ID<span class="p">,</span> <span class="p">]</span>

    <span class="kp">paste0</span><span class="p">(</span><span class="s">&quot;&lt;b&gt;&quot;</span><span class="p">,</span> <span class="s">&quot;State: &quot;</span><span class="p">,</span> mdClms<span class="o">$</span>State<span class="p">,</span> <span class="s">&quot;&lt;/b&gt;&lt;br&gt;&quot;</span><span class="p">,</span>
            <span class="s">&quot;Provider Name: &quot;</span><span class="p">,</span> mdClms<span class="o">$</span>Hospital_Name<span class="p">,</span> <span class="s">&quot;&lt;br&gt;&quot;</span><span class="p">,</span>
            <span class="s">&quot;Spending: &quot;</span><span class="p">,</span> <span class="s">&quot;$&quot;</span><span class="p">,</span> <span class="kp">format</span><span class="p">(</span>mdClms<span class="o">$</span>AvgSpndngHsptl<span class="p">,</span> big.mark <span class="o">=</span> <span class="s">&quot;,&quot;</span><span class="p">,</span> scientific <span class="o">=</span> <span class="kc">FALSE</span><span class="p">)</span>
    <span class="p">)</span>
  <span class="p">}</span>

  <span class="c1"># A reactive expression with the ggvis plot</span>
  vis <span class="o">&lt;-</span> reactive<span class="p">({</span>
        mdClmFnl<span class="p">()</span> <span class="o">%&gt;%</span>
        ggvis<span class="p">(</span>x <span class="o">=</span> <span class="o">~</span>ID <span class="p">,</span> y <span class="o">=</span> <span class="o">~</span>AvgSpndngHsptl<span class="p">)</span> <span class="o">%&gt;%</span>
        layer_points<span class="p">(</span>size <span class="o">:=</span> <span class="m">100</span><span class="p">,</span> size.hover <span class="o">:=</span> <span class="m">300</span><span class="p">,</span> 
            fillOpacity <span class="o">:=</span> <span class="m">0.1</span><span class="p">,</span> fillOpacity.hover <span class="o">:=</span> <span class="m">0.5</span><span class="p">,</span> stroke.hover <span class="o">:=</span> <span class="s">&quot;red&quot;</span><span class="p">,</span> fill.hover <span class="o">:=</span><span class="s">&quot;red&quot;</span><span class="p">,</span>
                stroke <span class="o">=</span> <span class="o">~</span>AvgSpndngHsptl<span class="p">,</span> key <span class="o">:=</span> <span class="o">~</span>ID<span class="p">)</span> <span class="o">%&gt;%</span>
        add_tooltip<span class="p">(</span>mdclm_tooltip<span class="p">,</span> on <span class="o">=</span> <span class="kt">c</span><span class="p">(</span><span class="s">&quot;hover&quot;</span><span class="p">))</span> <span class="o">%&gt;%</span>
        add_axis<span class="p">(</span><span class="s">&quot;x&quot;</span><span class="p">,</span> title <span class="o">=</span> <span class="s">&quot;Provider&quot;</span><span class="p">,</span> properties <span class="o">=</span> axis_props<span class="p">(</span>title <span class="o">=</span> <span class="kt">list</span><span class="p">(</span>fontSize <span class="o">=</span> <span class="m">16</span><span class="p">)))</span> <span class="o">%&gt;%</span>
        add_axis<span class="p">(</span><span class="s">&quot;y&quot;</span><span class="p">,</span> title <span class="o">=</span> <span class="s">&quot;Medicare Hospital Spending by Claim&quot;</span><span class="p">,</span> title_offset<span class="o">=</span><span class="m">50</span><span class="p">,</span>
                properties <span class="o">=</span> axis_props<span class="p">(</span>title <span class="o">=</span> <span class="kt">list</span><span class="p">(</span>fontSize <span class="o">=</span> <span class="m">16</span><span class="p">)))</span> <span class="o">%&gt;%</span>
        add_legend<span class="p">(</span><span class="s">&quot;stroke&quot;</span><span class="p">,</span> title <span class="o">=</span> <span class="s">&quot;Average Spending&quot;</span><span class="p">)</span> <span class="o">%&gt;%</span>
        set_options<span class="p">(</span>width <span class="o">=</span> <span class="m">1000</span><span class="p">,</span> height <span class="o">=</span> <span class="m">500</span><span class="p">)</span>
    <span class="p">})</span>

  vis <span class="o">%&gt;%</span> bind_shiny<span class="p">(</span><span class="s">&quot;sctrPlot&quot;</span><span class="p">)</span>

  output<span class="o">$</span>nmbrProviders <span class="o">&lt;-</span> renderText<span class="p">({</span> <span class="kp">length</span><span class="p">(</span><span class="kp">unique</span><span class="p">(</span>mdClmFnl<span class="p">()</span><span class="o">$</span>Hospital_Name<span class="p">))</span> <span class="p">})</span>

  <span class="c1"># Summary statistics </span>
  output<span class="o">$</span>smryTable <span class="o">&lt;-</span> renderPrint<span class="p">({</span>
    AvgSpndngpEH <span class="o">&lt;-</span> <span class="kt">data.frame</span><span class="p">(</span>AvgSpndngpEH<span class="o">=</span>mdClmFnl<span class="p">()</span><span class="o">$</span>AvgSpndngHsptl<span class="p">)</span>
    <span class="kr">if</span><span class="p">(</span><span class="kp">nrow</span><span class="p">(</span>AvgSpndngpEH<span class="p">)</span> <span class="o">&gt;</span> <span class="m">0</span><span class="p">){</span>
        stargazer<span class="p">(</span>AvgSpndngpEH <span class="p">,</span> type <span class="o">=</span> <span class="s">&quot;text&quot;</span><span class="p">,</span> title<span class="o">=</span><span class="s">&quot;Summary of Medicare Average Spending per Episode Hospital&quot;</span><span class="p">,</span> digits<span class="o">=</span><span class="m">0</span><span class="p">,</span> median<span class="o">=</span><span class="kc">TRUE</span><span class="p">,</span> iqr<span class="o">=</span><span class="kc">TRUE</span><span class="p">,</span> min.max<span class="o">=</span><span class="kc">TRUE</span><span class="p">)</span>
    <span class="p">}</span> <span class="kr">else</span> <span class="p">{</span>
    <span class="kp">print</span><span class="p">(</span><span class="kp">paste</span><span class="p">(</span><span class="s">&quot;No Observation&quot;</span><span class="p">))</span>
    <span class="p">}</span>
  <span class="p">})</span>
  

  mdClmFnl <span class="o">&lt;-</span> reactive<span class="p">({</span>
    <span class="c1"># Apply filters</span>
    mdClm <span class="o">%&gt;%</span>
    filter<span class="p">(</span>State <span class="o">==</span> input<span class="o">$</span>state<span class="p">,</span> Period <span class="o">==</span> input<span class="o">$</span>period<span class="p">,</span> Claim_Type <span class="o">==</span> input<span class="o">$</span>clmType<span class="p">)</span> 
  <span class="p">})</span>
  
  
  
  OrdrdBySpndng <span class="o">&lt;-</span> reactive<span class="p">({</span>
    <span class="c1"># Apply filters</span>
    mdClm <span class="o">%&gt;%</span>
    arrange<span class="p">(</span>desc<span class="p">(</span>AvgSpndngHsptl<span class="p">))</span> <span class="o">%&gt;%</span>
    filter<span class="p">(</span>State <span class="o">==</span> input<span class="o">$</span>state<span class="p">,</span> Period <span class="o">==</span> input<span class="o">$</span>period<span class="p">,</span> Claim_Type <span class="o">==</span> input<span class="o">$</span>clmType<span class="p">)</span>  
    <span class="p">})</span>

    output<span class="o">$</span>topProviders <span class="o">&lt;-</span> renderText<span class="p">({</span><span class="kp">head</span><span class="p">(</span>OrdrdBySpndng<span class="p">()</span><span class="o">$</span>prvdrSpndng<span class="p">,</span> n<span class="o">=</span><span class="m">10</span><span class="p">)</span> <span class="p">})</span>
<span class="p">}</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-r"><pre><span></span>
</pre></div>

</div>
</div>
</div>

</div>
    </div>
  </div>
  
  

<!--comment line starst here -->
<div id="disqus_thread"></div>
<script>
/**
*  RECOMMENDED CONFIGURATION VARIABLES: EDIT AND UNCOMMENT THE SECTION BELOW TO INSERT DYNAMIC VALUES FROM YOUR PLATFORM OR CMS.
*  LEARN WHY DEFINING THESE VARIABLES IS IMPORTANT: https://disqus.com/admin/universalcode/#configuration-variables*/
var disqus_config = function () {
this.page.url = 'http://datascienceandme.com/RShinyMedicareCodes.html';  // Replace PAGE_URL with your page's canonical URL variable
//this.page.identifier = PAGE_IDENTIFIER; // Replace PAGE_IDENTIFIER with your page's unique identifier variable
this.page.title = 'R Shiny Apps: Exploring Medicare Spending Across Providers'
};
(function() { // DON'T EDIT BELOW THIS LINE
var d = document, s = d.createElement('script');
s.src = '//datascienceandme-com-1.disqus.com/embed.js';
s.setAttribute('data-timestamp', +new Date());
(d.head || d.body).appendChild(s);
})();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<script id="dsq-count-scr" src="//datascienceandme-com-1.disqus.com/count.js" async></script>                                


	<!-- Page footer rows -->
	<footer>
	  <p>&#169; 2016 Muluemebet G. Ayalew</p>
	</footer>
	
	
  
</body>
</html>
